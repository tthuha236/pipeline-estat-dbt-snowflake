[0m22:56:52.657061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b830690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8a2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8a2790>]}


============================== 22:56:52.665701 | 02e17d91-a1f3-476b-977b-4b5fda60c3d3 ==============================
[0m22:56:52.665701 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:56:52.666599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:56:53.619592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02e17d91-a1f3-476b-977b-4b5fda60c3d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c512b10>]}
[0m22:56:53.680416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02e17d91-a1f3-476b-977b-4b5fda60c3d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4b3a10>]}
[0m22:56:53.681945 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:56:53.930691 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m22:56:53.931682 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:56:53.932146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02e17d91-a1f3-476b-977b-4b5fda60c3d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7f04d0>]}
[0m22:56:55.017510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.example
[0m22:56:55.023171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02e17d91-a1f3-476b-977b-4b5fda60c3d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8019d0>]}
[0m22:56:55.084528 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m22:56:55.088503 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m22:56:55.121299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02e17d91-a1f3-476b-977b-4b5fda60c3d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caef210>]}
[0m22:56:55.121841 [info ] [MainThread]: Found 1 model, 477 macros
[0m22:56:55.122225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e17d91-a1f3-476b-977b-4b5fda60c3d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5fdbd0>]}
[0m22:56:55.124130 [info ] [MainThread]: 
[0m22:56:55.124706 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m22:56:55.125117 [info ] [MainThread]: 
[0m22:56:55.125887 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:56:55.127066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m22:56:55.220277 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m22:56:55.220720 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m22:56:55.221028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:58.737408 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.516 seconds
[0m22:56:58.742301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_stg)
[0m22:56:58.762941 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_stg"
[0m22:56:58.763589 [debug] [ThreadPool]: On list_estat_db_estat_stg: show objects in estat_db.estat_stg
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_stg"} */;
[0m22:56:58.883241 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.119 seconds
[0m22:56:58.889326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02e17d91-a1f3-476b-977b-4b5fda60c3d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c948910>]}
[0m22:56:58.897539 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m22:56:58.898816 [info ] [Thread-1 (]: 1 of 1 START sql view model estat_stg.fact_expense ............................. [RUN]
[0m22:56:58.899845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_stg, now model.estat_dbt.fact_expense)
[0m22:56:58.900639 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m22:56:58.913828 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m22:56:58.915679 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m22:56:58.950120 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m22:56:58.951925 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:56:58.952404 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace   view estat_db.estat_stg.fact_expense
  
  
  
  
  as (
    WITH fact_expense_stg AS (
    SELECT * FROM ESTAT_DB.ESTAT_STG.fact_expense_stg
)
SELECT 
    CATEGORY_CD,
    AMOUNT, 
    AREA_CD, 
    YEAR,
    MONTH,
    CURRENT_TIMESTAMP(),
    CURRENT_TIMESTAMP()
FROM fact_expense_stg

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m22:56:59.059677 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc004-0002-9cc8-0002-73ea0009ab3e
[0m22:56:59.060672 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 139 unexpected ';'.
[0m22:56:59.068691 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 139 unexpected ';'.
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql
[0m22:56:59.071837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02e17d91-a1f3-476b-977b-4b5fda60c3d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcb7e10>]}
[0m22:56:59.072879 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model estat_stg.fact_expense .................... [[31mERROR[0m in 0.17s]
[0m22:56:59.073779 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m22:56:59.074584 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 139 unexpected ';'.
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql.
[0m22:56:59.077547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:59.078105 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m22:56:59.078543 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m22:56:59.397374 [info ] [MainThread]: 
[0m22:56:59.398610 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.27 seconds (4.27s).
[0m22:56:59.400828 [debug] [MainThread]: Command end result
[0m22:56:59.445910 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m22:56:59.449784 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m22:56:59.458835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m22:56:59.459350 [info ] [MainThread]: 
[0m22:56:59.459977 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:56:59.460667 [info ] [MainThread]: 
[0m22:56:59.461513 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense.sql)[0m
[0m22:56:59.462367 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 139 unexpected ';'.
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql
[0m22:56:59.462928 [info ] [MainThread]: 
[0m22:56:59.463644 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense.sql
[0m22:56:59.464189 [info ] [MainThread]: 
[0m22:56:59.464932 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:56:59.467034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.8960443, "process_in_blocks": "0", "process_kernel_time": 0.951544, "process_mem_max_rss": "150056960", "process_out_blocks": "0", "process_user_time": 4.104535}
[0m22:56:59.467951 [debug] [MainThread]: Command `dbt run` failed at 22:56:59.467744 after 6.90 seconds
[0m22:56:59.468816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711ddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b889690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b888410>]}
[0m22:56:59.469434 [debug] [MainThread]: Flushing usage events
[0m22:57:01.164702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:47.386098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114278c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142ea610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142ead90>]}


============================== 22:59:47.392993 | 0588f4ee-e50c-439c-b7d2-b1beb9d4aa3a ==============================
[0m22:59:47.392993 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:59:47.393757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:48.221317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0588f4ee-e50c-439c-b7d2-b1beb9d4aa3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b3a290>]}
[0m22:59:48.283728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0588f4ee-e50c-439c-b7d2-b1beb9d4aa3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e47c50>]}
[0m22:59:48.285227 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:59:48.497508 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m22:59:48.677069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:59:48.677768 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense.sql
[0m22:59:48.911210 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.example
[0m22:59:48.917317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0588f4ee-e50c-439c-b7d2-b1beb9d4aa3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150b0190>]}
[0m22:59:48.976712 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m22:59:48.980040 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m22:59:49.014833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0588f4ee-e50c-439c-b7d2-b1beb9d4aa3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115550750>]}
[0m22:59:49.015573 [info ] [MainThread]: Found 1 model, 477 macros
[0m22:59:49.016073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0588f4ee-e50c-439c-b7d2-b1beb9d4aa3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154da2d0>]}
[0m22:59:49.017939 [info ] [MainThread]: 
[0m22:59:49.018502 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m22:59:49.018942 [info ] [MainThread]: 
[0m22:59:49.019741 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:59:49.020857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m22:59:49.091313 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m22:59:49.091928 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m22:59:49.092294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:51.227808 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.135 seconds
[0m22:59:51.232195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_stg)
[0m22:59:51.248649 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_stg"
[0m22:59:51.249118 [debug] [ThreadPool]: On list_estat_db_estat_stg: show objects in estat_db.estat_stg
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_stg"} */;
[0m22:59:51.401423 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.152 seconds
[0m22:59:51.407669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0588f4ee-e50c-439c-b7d2-b1beb9d4aa3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e94dd0>]}
[0m22:59:51.414785 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m22:59:51.415841 [info ] [Thread-1 (]: 1 of 1 START sql view model estat_stg.fact_expense ............................. [RUN]
[0m22:59:51.416756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_stg, now model.estat_dbt.fact_expense)
[0m22:59:51.417561 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m22:59:51.429459 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m22:59:51.431473 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m22:59:51.464822 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m22:59:51.466845 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:59:51.467299 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace   view estat_db.estat_stg.fact_expense
  
  
  
  
  as (
    WITH fact_expense_stg AS (
    SELECT * FROM ESTAT_DB.ESTAT_STG.fact_expense_stg
)
SELECT 
    CATEGORY_CD,
    AMOUNT, 
    AREA_CD, 
    YEAR,
    MONTH,
    CURRENT_TIMESTAMP(),
    CURRENT_TIMESTAMP()
FROM fact_expense_stg
  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m22:59:51.568250 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc007-0002-9dbc-0002-73ea000a61f2
[0m22:59:51.569196 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'ESTAT_STG'
[0m22:59:51.576709 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'ESTAT_STG'
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql
[0m22:59:51.579715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0588f4ee-e50c-439c-b7d2-b1beb9d4aa3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115234690>]}
[0m22:59:51.580803 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model estat_stg.fact_expense .................... [[31mERROR[0m in 0.16s]
[0m22:59:51.581749 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m22:59:51.582697 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'ESTAT_STG'
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql.
[0m22:59:51.585499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:51.586070 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m22:59:51.586512 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m22:59:51.670309 [info ] [MainThread]: 
[0m22:59:51.671228 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m22:59:51.673156 [debug] [MainThread]: Command end result
[0m22:59:51.704141 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m22:59:51.706229 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m22:59:51.712992 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m22:59:51.713365 [info ] [MainThread]: 
[0m22:59:51.713800 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:59:51.714309 [info ] [MainThread]: 
[0m22:59:51.715004 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense.sql)[0m
[0m22:59:51.715503 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'ESTAT_STG'
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql
[0m22:59:51.715962 [info ] [MainThread]: 
[0m22:59:51.716386 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense.sql
[0m22:59:51.716830 [info ] [MainThread]: 
[0m22:59:51.717232 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:59:51.718967 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4228053, "process_in_blocks": "0", "process_kernel_time": 0.74121, "process_mem_max_rss": "149192704", "process_out_blocks": "0", "process_user_time": 2.852527}
[0m22:59:51.719726 [debug] [MainThread]: Command `dbt run` failed at 22:59:51.719515 after 4.42 seconds
[0m22:59:51.720451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbc9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11430b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11430b9d0>]}
[0m22:59:51.720918 [debug] [MainThread]: Flushing usage events
[0m22:59:53.847093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:10:42.738081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c8c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cfe5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cfe9d0>]}


============================== 23:10:42.746654 | 050ee1e4-5730-46cb-9709-eb7949dca5f6 ==============================
[0m23:10:42.746654 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:10:42.747619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'profiles_dir': '/Users/tthuha236/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:10:43.587772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '050ee1e4-5730-46cb-9709-eb7949dca5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149f4050>]}
[0m23:10:43.664135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '050ee1e4-5730-46cb-9709-eb7949dca5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11490bf50>]}
[0m23:10:43.666031 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m23:10:43.911987 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:10:43.987202 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:10:43.987874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '050ee1e4-5730-46cb-9709-eb7949dca5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135f2790>]}
[0m23:10:45.203170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m23:10:45.209516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '050ee1e4-5730-46cb-9709-eb7949dca5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d65810>]}
[0m23:10:45.277067 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m23:10:45.282831 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m23:10:45.323492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '050ee1e4-5730-46cb-9709-eb7949dca5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ce15d0>]}
[0m23:10:45.324161 [info ] [MainThread]: Found 1 model, 477 macros
[0m23:10:45.324714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '050ee1e4-5730-46cb-9709-eb7949dca5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114df76d0>]}
[0m23:10:45.326829 [info ] [MainThread]: 
[0m23:10:45.327663 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m23:10:45.328200 [info ] [MainThread]: 
[0m23:10:45.329130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:45.330685 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m23:10:45.403821 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m23:10:45.404243 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m23:10:45.404549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:46.808400 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.403 seconds
[0m23:10:46.816154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_stg)
[0m23:10:46.837275 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_stg"
[0m23:10:46.837852 [debug] [ThreadPool]: On list_estat_db_estat_stg: show objects in estat_db.estat_stg
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_stg"} */;
[0m23:10:46.971242 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.133 seconds
[0m23:10:46.976985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '050ee1e4-5730-46cb-9709-eb7949dca5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114df4b10>]}
[0m23:10:46.984000 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m23:10:46.985082 [info ] [Thread-1 (]: 1 of 1 START sql table model estat_stg.fact_expense ............................ [RUN]
[0m23:10:46.985967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_stg, now model.estat_dbt.fact_expense)
[0m23:10:46.986901 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m23:10:46.998148 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m23:10:46.999353 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m23:10:47.042320 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m23:10:47.045250 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m23:10:47.046012 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace transient table estat_db.estat_stg.fact_expense
    
    
    
    as (WITH fact_expense_stg AS (
    SELECT * FROM ESTAT_DB.ESTAT_STG.fact_expense_stg
)
SELECT 
    CATEGORY_CD,
    AMOUNT, 
    AREA_CD, 
    YEAR,
    MONTH,
    CURRENT_TIMESTAMP(),
    CURRENT_TIMESTAMP()
FROM fact_expense_stg
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m23:10:47.283035 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc012-0002-9d3d-0002-73ea000a128e
[0m23:10:47.283929 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m23:10:47.290556 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql
[0m23:10:47.293226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '050ee1e4-5730-46cb-9709-eb7949dca5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ffd810>]}
[0m23:10:47.294248 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model estat_stg.fact_expense ................... [[31mERROR[0m in 0.31s]
[0m23:10:47.295429 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m23:10:47.296549 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql.
[0m23:10:47.299436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:47.299975 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m23:10:47.300388 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m23:10:47.437933 [info ] [MainThread]: 
[0m23:10:47.439065 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m23:10:47.441006 [debug] [MainThread]: Command end result
[0m23:10:47.476913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m23:10:47.479511 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m23:10:47.487833 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m23:10:47.488576 [info ] [MainThread]: 
[0m23:10:47.489028 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:10:47.489406 [info ] [MainThread]: 
[0m23:10:47.490175 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense.sql)[0m
[0m23:10:47.490971 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql
[0m23:10:47.491438 [info ] [MainThread]: 
[0m23:10:47.491870 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense.sql
[0m23:10:47.492287 [info ] [MainThread]: 
[0m23:10:47.492706 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:10:47.494472 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.848146, "process_in_blocks": "0", "process_kernel_time": 0.823658, "process_mem_max_rss": "147382272", "process_out_blocks": "0", "process_user_time": 4.126249}
[0m23:10:47.495185 [debug] [MainThread]: Command `dbt run` failed at 23:10:47.494973 after 4.85 seconds
[0m23:10:47.495712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f579dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4d2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116117690>]}
[0m23:10:47.496114 [debug] [MainThread]: Flushing usage events
[0m23:10:49.212712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:09.068226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f91a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f91acd0>]}


============================== 23:14:09.076928 | 3c6595e6-fac2-411a-aca6-e3e26e83d5fb ==============================
[0m23:14:09.076928 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:14:09.078261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:14:09.859535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c6595e6-fac2-411a-aca6-e3e26e83d5fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104735d0>]}
[0m23:14:09.932857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c6595e6-fac2-411a-aca6-e3e26e83d5fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110527d10>]}
[0m23:14:09.934677 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m23:14:10.165355 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:14:10.322817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:14:10.323358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:14:10.329434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m23:14:10.356423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c6595e6-fac2-411a-aca6-e3e26e83d5fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11095cbd0>]}
[0m23:14:10.424002 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m23:14:10.430039 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m23:14:10.466586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c6595e6-fac2-411a-aca6-e3e26e83d5fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110869710>]}
[0m23:14:10.467212 [info ] [MainThread]: Found 1 model, 477 macros
[0m23:14:10.467607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c6595e6-fac2-411a-aca6-e3e26e83d5fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b66d0>]}
[0m23:14:10.469494 [info ] [MainThread]: 
[0m23:14:10.470058 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m23:14:10.470890 [info ] [MainThread]: 
[0m23:14:10.472089 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:14:10.473339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m23:14:10.546457 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m23:14:10.547344 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m23:14:10.547707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:14:12.330008 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.782 seconds
[0m23:14:12.336582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_stg)
[0m23:14:12.358925 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_stg"
[0m23:14:12.359561 [debug] [ThreadPool]: On list_estat_db_estat_stg: show objects in estat_db.estat_stg
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_stg"} */;
[0m23:14:12.489659 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.130 seconds
[0m23:14:12.495660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c6595e6-fac2-411a-aca6-e3e26e83d5fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109adb90>]}
[0m23:14:12.502359 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m23:14:12.503529 [info ] [Thread-1 (]: 1 of 1 START sql table model estat_stg.fact_expense ............................ [RUN]
[0m23:14:12.504595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_stg, now model.estat_dbt.fact_expense)
[0m23:14:12.505456 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m23:14:12.516927 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m23:14:12.518184 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m23:14:12.557238 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m23:14:12.559392 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m23:14:12.559909 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace transient table estat_db.estat_stg.fact_expense
    
    
    
    as (WITH fact_expense_stg AS (
    SELECT * FROM ESTAT_DB.ESTAT_STG.fact_expense_stg
)
SELECT 
    CATEGORY_CD,
    AMOUNT, 
    AREA_CD, 
    YEAR,
    MONTH,
    CURRENT_TIMESTAMP(),
    CURRENT_TIMESTAMP()
FROM fact_expense_stg
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m23:14:12.787375 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc016-0002-9dbc-0002-73ea000a62b6
[0m23:14:12.787952 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m23:14:12.793276 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql
[0m23:14:12.795865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c6595e6-fac2-411a-aca6-e3e26e83d5fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a42390>]}
[0m23:14:12.796954 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model estat_stg.fact_expense ................... [[31mERROR[0m in 0.29s]
[0m23:14:12.798127 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m23:14:12.798895 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql.
[0m23:14:12.801154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:12.801617 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m23:14:12.802019 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m23:14:12.859426 [info ] [MainThread]: 
[0m23:14:12.860124 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m23:14:12.861472 [debug] [MainThread]: Command end result
[0m23:14:12.888727 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m23:14:12.890459 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m23:14:12.896984 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m23:14:12.897517 [info ] [MainThread]: 
[0m23:14:12.898236 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:14:12.898956 [info ] [MainThread]: 
[0m23:14:12.899757 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense.sql)[0m
[0m23:14:12.900746 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql
[0m23:14:12.901461 [info ] [MainThread]: 
[0m23:14:12.902391 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense.sql
[0m23:14:12.902928 [info ] [MainThread]: 
[0m23:14:12.903683 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:14:12.905509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.9261906, "process_in_blocks": "0", "process_kernel_time": 0.762775, "process_mem_max_rss": "145080320", "process_out_blocks": "0", "process_user_time": 2.835733}
[0m23:14:12.906183 [debug] [MainThread]: Command `dbt run` failed at 23:14:12.906031 after 3.93 seconds
[0m23:14:12.906785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b199d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0f2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f898210>]}
[0m23:14:12.907520 [debug] [MainThread]: Flushing usage events
[0m23:14:15.055452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:03.657760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce34750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce36110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cea6ad0>]}


============================== 23:18:03.664944 | 6ad7a6d0-3fc1-480d-bd6d-eb47133ba551 ==============================
[0m23:18:03.664944 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:18:03.665741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:18:04.392236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ad7a6d0-3fc1-480d-bd6d-eb47133ba551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce6cbd0>]}
[0m23:18:04.459684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ad7a6d0-3fc1-480d-bd6d-eb47133ba551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dab3f50>]}
[0m23:18:04.461666 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m23:18:04.695489 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:18:04.846538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:18:04.847239 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense.sql
[0m23:18:05.092201 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m23:18:05.098304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ad7a6d0-3fc1-480d-bd6d-eb47133ba551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de28f50>]}
[0m23:18:05.159574 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m23:18:05.162834 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m23:18:05.194105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ad7a6d0-3fc1-480d-bd6d-eb47133ba551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1b0650>]}
[0m23:18:05.194657 [info ] [MainThread]: Found 1 model, 477 macros
[0m23:18:05.195097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad7a6d0-3fc1-480d-bd6d-eb47133ba551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e00d250>]}
[0m23:18:05.197167 [info ] [MainThread]: 
[0m23:18:05.197707 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m23:18:05.198114 [info ] [MainThread]: 
[0m23:18:05.198855 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:18:05.200180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m23:18:05.268168 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m23:18:05.268613 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m23:18:05.268914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:06.769239 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.500 seconds
[0m23:18:06.774320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_stg)
[0m23:18:06.794348 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_stg"
[0m23:18:06.795086 [debug] [ThreadPool]: On list_estat_db_estat_stg: show objects in estat_db.estat_stg
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_stg"} */;
[0m23:18:06.886552 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.091 seconds
[0m23:18:06.892024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad7a6d0-3fc1-480d-bd6d-eb47133ba551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e08e950>]}
[0m23:18:06.899236 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m23:18:06.900530 [info ] [Thread-1 (]: 1 of 1 START sql table model estat_stg.fact_expense ............................ [RUN]
[0m23:18:06.901543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_stg, now model.estat_dbt.fact_expense)
[0m23:18:06.902461 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m23:18:06.912424 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m23:18:06.913924 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m23:18:06.947681 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m23:18:06.949038 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m23:18:06.949444 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace transient table estat_db.estat_stg.fact_expense
    
    
    
    as (WITH stg_table AS (
    SELECT * FROM ESTAT_DB.ESTAT_STG.fact_expense_stg
)
SELECT 
    CATEGORY_CD,
    AMOUNT, 
    AREA_CD, 
    YEAR,
    MONTH,
    CURRENT_TIMESTAMP(),
    CURRENT_TIMESTAMP()
FROM stg_table
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m23:18:07.282512 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc01a-0002-9d38-0002-73ea000943ea
[0m23:18:07.283384 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m23:18:07.291042 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql
[0m23:18:07.294511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ad7a6d0-3fc1-480d-bd6d-eb47133ba551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e04ae50>]}
[0m23:18:07.295792 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model estat_stg.fact_expense ................... [[31mERROR[0m in 0.39s]
[0m23:18:07.296948 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m23:18:07.297853 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql.
[0m23:18:07.300706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:07.301299 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m23:18:07.301775 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m23:18:07.385099 [info ] [MainThread]: 
[0m23:18:07.386241 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m23:18:07.388162 [debug] [MainThread]: Command end result
[0m23:18:07.421532 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m23:18:07.424393 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m23:18:07.431259 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m23:18:07.431781 [info ] [MainThread]: 
[0m23:18:07.432263 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:18:07.432657 [info ] [MainThread]: 
[0m23:18:07.433162 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense.sql)[0m
[0m23:18:07.433677 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/estat_dbt/models/transformed/fact_expense.sql
[0m23:18:07.434022 [info ] [MainThread]: 
[0m23:18:07.434421 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense.sql
[0m23:18:07.434822 [info ] [MainThread]: 
[0m23:18:07.435206 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:18:07.436922 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.8569684, "process_in_blocks": "0", "process_kernel_time": 0.721791, "process_mem_max_rss": "149581824", "process_out_blocks": "0", "process_user_time": 2.944444}
[0m23:18:07.437570 [debug] [MainThread]: Command `dbt run` failed at 23:18:07.437453 after 3.86 seconds
[0m23:18:07.438009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cec7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cec7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce8e7d0>]}
[0m23:18:07.438368 [debug] [MainThread]: Flushing usage events
[0m23:18:09.223841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:36.331640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e78e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eeec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eef3d0>]}


============================== 23:18:36.340588 | 0bdc461c-2604-4cbe-8b30-ef769dc076b4 ==============================
[0m23:18:36.340588 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:18:36.341621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:18:37.134823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bdc461c-2604-4cbe-8b30-ef769dc076b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8f5d0>]}
[0m23:18:37.204298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bdc461c-2604-4cbe-8b30-ef769dc076b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a84290>]}
[0m23:18:37.206294 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m23:18:37.412641 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:18:37.565649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:18:37.566430 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense.sql
[0m23:18:37.810016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m23:18:37.815916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bdc461c-2604-4cbe-8b30-ef769dc076b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107053d50>]}
[0m23:18:37.874995 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m23:18:37.879542 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m23:18:37.916655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bdc461c-2604-4cbe-8b30-ef769dc076b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f80ad0>]}
[0m23:18:37.917366 [info ] [MainThread]: Found 1 model, 477 macros
[0m23:18:37.917791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bdc461c-2604-4cbe-8b30-ef769dc076b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107082a10>]}
[0m23:18:37.920034 [info ] [MainThread]: 
[0m23:18:37.920621 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m23:18:37.921037 [info ] [MainThread]: 
[0m23:18:37.921700 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:18:37.922764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m23:18:37.995954 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m23:18:37.996389 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m23:18:37.996695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:39.111800 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.115 seconds
[0m23:18:39.118160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_stg)
[0m23:18:39.140095 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_stg"
[0m23:18:39.140690 [debug] [ThreadPool]: On list_estat_db_estat_stg: show objects in estat_db.estat_stg
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_stg"} */;
[0m23:18:39.252955 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.111 seconds
[0m23:18:39.259036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bdc461c-2604-4cbe-8b30-ef769dc076b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbca50>]}
[0m23:18:39.268482 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m23:18:39.270012 [info ] [Thread-1 (]: 1 of 1 START sql table model estat_stg.fact_expense ............................ [RUN]
[0m23:18:39.271242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_stg, now model.estat_dbt.fact_expense)
[0m23:18:39.272275 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m23:18:39.286027 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m23:18:39.288025 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m23:18:39.327504 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m23:18:39.328867 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m23:18:39.329276 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace transient table estat_db.estat_stg.fact_expense
    
    
    
    as (WITH stg_table AS (
    SELECT * FROM ESTAT_DB.ESTAT_STG.fact_expense_stg
)
SELECT 
    CATEGORY_CD,
    AMOUNT, 
    AREA_CD, 
    YEAR,
    MONTH,
    CURRENT_TIMESTAMP() as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m23:18:40.542965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.213 seconds
[0m23:18:40.584708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bdc461c-2604-4cbe-8b30-ef769dc076b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108347f90>]}
[0m23:18:40.585719 [info ] [Thread-1 (]: 1 of 1 OK created sql table model estat_stg.fact_expense ....................... [[32mSUCCESS 1[0m in 1.31s]
[0m23:18:40.586447 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m23:18:40.588254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:40.588672 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m23:18:40.589047 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m23:18:40.726777 [info ] [MainThread]: 
[0m23:18:40.727820 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m23:18:40.729380 [debug] [MainThread]: Command end result
[0m23:18:40.765401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m23:18:40.768870 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m23:18:40.775571 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m23:18:40.776375 [info ] [MainThread]: 
[0m23:18:40.776865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:40.777347 [info ] [MainThread]: 
[0m23:18:40.777853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:18:40.779914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.530005, "process_in_blocks": "0", "process_kernel_time": 0.743001, "process_mem_max_rss": "148357120", "process_out_blocks": "0", "process_user_time": 3.000775}
[0m23:18:40.780562 [debug] [MainThread]: Command `dbt run` succeeded at 23:18:40.780427 after 4.53 seconds
[0m23:18:40.781093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1017b5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101659e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e68150>]}
[0m23:18:40.781484 [debug] [MainThread]: Flushing usage events
[0m23:18:41.589453 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:53.485282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113656a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136cab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136caf90>]}


============================== 08:51:53.493971 | 3e57baa0-9043-4b8f-99ad-c55cc44992a5 ==============================
[0m08:51:53.493971 [info ] [MainThread]: Running with dbt=1.10.4
[0m08:51:53.495034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:51:54.286914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e57baa0-9043-4b8f-99ad-c55cc44992a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135a5410>]}
[0m08:51:54.366443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e57baa0-9043-4b8f-99ad-c55cc44992a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114260350>]}
[0m08:51:54.368536 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m08:51:54.587754 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m08:51:54.661302 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:51:54.661910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e57baa0-9043-4b8f-99ad-c55cc44992a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112830710>]}
[0m08:51:55.603743 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.estat_dbt.fact_expense' (models/transformed/fact_expense.sql) depends on a node named 'input_schema' which was not found
[0m08:51:55.605787 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2301395, "process_in_blocks": "0", "process_kernel_time": 0.659732, "process_mem_max_rss": "132710400", "process_out_blocks": "0", "process_user_time": 3.169044}
[0m08:51:55.606632 [debug] [MainThread]: Command `dbt run` failed at 08:51:55.606472 after 2.23 seconds
[0m08:51:55.607145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113654a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef91e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133fb610>]}
[0m08:51:55.607663 [debug] [MainThread]: Flushing usage events
[0m08:51:57.458562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:10.287741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa7a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faeec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faef0d0>]}


============================== 08:55:10.295437 | 3727bf67-2bde-4d2c-bb0b-246efb97020e ==============================
[0m08:55:10.295437 [info ] [MainThread]: Running with dbt=1.10.4
[0m08:55:10.296333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:55:11.015684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3727bf67-2bde-4d2c-bb0b-246efb97020e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fad4750>]}
[0m08:55:11.080384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3727bf67-2bde-4d2c-bb0b-246efb97020e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106843d0>]}
[0m08:55:11.082179 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m08:55:11.297156 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m08:55:11.365407 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:55:11.366100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3727bf67-2bde-4d2c-bb0b-246efb97020e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec587d0>]}
[0m08:55:12.331109 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.estat_dbt.fact_expense' (models/transformed/fact_expense.sql) depends on a node named 'input_schema' which was not found
[0m08:55:12.333079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1242774, "process_in_blocks": "0", "process_kernel_time": 0.635803, "process_mem_max_rss": "132427776", "process_out_blocks": "0", "process_user_time": 3.210013}
[0m08:55:12.333928 [debug] [MainThread]: Command `dbt run` failed at 08:55:12.333794 after 2.13 seconds
[0m08:55:12.334497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3b5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb0fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb0f810>]}
[0m08:55:12.335012 [debug] [MainThread]: Flushing usage events
[0m08:55:13.941180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:11.612685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112120d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112192210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112192650>]}


============================== 09:20:11.620968 | 81037d7a-7ff8-499c-b092-f8d2087ecedc ==============================
[0m09:20:11.620968 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:20:11.622637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'profiles_dir': '/Users/tthuha236/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:20:12.429309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81037d7a-7ff8-499c-b092-f8d2087ecedc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d29050>]}
[0m09:20:12.496056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81037d7a-7ff8-499c-b092-f8d2087ecedc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cebe90>]}
[0m09:20:12.497947 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:20:12.714912 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:20:12.785787 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:20:12.786475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '81037d7a-7ff8-499c-b092-f8d2087ecedc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa29d0>]}
[0m09:20:13.867210 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.estat_dbt.fact_expense' (models/transformed/fact_expense.sql) depends on a node named 'input_schema' which was not found
[0m09:20:13.869213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3442228, "process_in_blocks": "0", "process_kernel_time": 0.679027, "process_mem_max_rss": "133107712", "process_out_blocks": "0", "process_user_time": 3.346459}
[0m09:20:13.870166 [debug] [MainThread]: Command `dbt run` failed at 09:20:13.869963 after 2.35 seconds
[0m09:20:13.870916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da71cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f6d990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113211410>]}
[0m09:20:13.871467 [debug] [MainThread]: Flushing usage events
[0m09:20:15.509582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:30.629604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f048490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0bdd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0bed10>]}


============================== 09:20:30.639089 | d9b23147-7d8b-4b40-9065-1fe3f7aea65c ==============================
[0m09:20:30.639089 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:20:30.640027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:20:31.421810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9b23147-7d8b-4b40-9065-1fe3f7aea65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdb2550>]}
[0m09:20:31.485440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9b23147-7d8b-4b40-9065-1fe3f7aea65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc54610>]}
[0m09:20:31.487891 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:20:31.698808 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:20:31.766720 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:20:31.767435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd9b23147-7d8b-4b40-9065-1fe3f7aea65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9b2910>]}
[0m09:20:32.802538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m09:20:32.808346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9b23147-7d8b-4b40-9065-1fe3f7aea65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100fb6d0>]}
[0m09:20:32.872051 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:20:32.876328 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:20:32.914289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9b23147-7d8b-4b40-9065-1fe3f7aea65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110233510>]}
[0m09:20:32.915013 [info ] [MainThread]: Found 1 model, 477 macros
[0m09:20:32.915492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9b23147-7d8b-4b40-9065-1fe3f7aea65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110315e50>]}
[0m09:20:32.917888 [info ] [MainThread]: 
[0m09:20:32.918608 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:20:32.919221 [info ] [MainThread]: 
[0m09:20:32.920081 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:20:32.921488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m09:20:32.998420 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m09:20:32.998893 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m09:20:32.999284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:34.464393 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.465 seconds
[0m09:20:34.469688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now create_estat_db_estat_stg_estat_transformed)
[0m09:20:34.471942 [debug] [ThreadPool]: Creating schema "database: "estat_db"
schema: "estat_stg_estat_transformed"
"
[0m09:20:34.482849 [debug] [ThreadPool]: Using snowflake connection "create_estat_db_estat_stg_estat_transformed"
[0m09:20:34.483598 [debug] [ThreadPool]: On create_estat_db_estat_stg_estat_transformed: create schema if not exists estat_db.estat_stg_estat_transformed
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "create_estat_db_estat_stg_estat_transformed"} */
[0m09:20:34.867666 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdc274-0002-9e27-0002-73ea000ac006
[0m09:20:34.868570 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:20:34.869453 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m09:20:34.870073 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:20:34.871364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:34.871965 [debug] [MainThread]: Connection 'create_estat_db_estat_stg_estat_transformed' was left open.
[0m09:20:34.872521 [debug] [MainThread]: On create_estat_db_estat_stg_estat_transformed: Close
[0m09:20:34.992504 [info ] [MainThread]: 
[0m09:20:34.993707 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m09:20:34.995222 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:20:34.999252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.452746, "process_in_blocks": "0", "process_kernel_time": 0.696651, "process_mem_max_rss": "146784256", "process_out_blocks": "0", "process_user_time": 3.554685}
[0m09:20:35.000640 [debug] [MainThread]: Command `dbt run` failed at 09:20:35.000352 after 4.45 seconds
[0m09:20:35.001559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a985e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0a9ed0>]}
[0m09:20:35.002450 [debug] [MainThread]: Flushing usage events
[0m09:20:35.886307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:22:37.444717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109608a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967ac50>]}


============================== 09:22:37.453060 | 40bccf95-77b6-42eb-b236-0471681f9adf ==============================
[0m09:22:37.453060 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:22:37.453850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:22:38.212975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40bccf95-77b6-42eb-b236-0471681f9adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109644b10>]}
[0m09:22:38.279177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40bccf95-77b6-42eb-b236-0471681f9adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2981d0>]}
[0m09:22:38.281022 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:22:38.492685 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:22:38.558743 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:22:38.559836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40bccf95-77b6-42eb-b236-0471681f9adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e8810>]}
[0m09:22:39.586971 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m09:22:39.592636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40bccf95-77b6-42eb-b236-0471681f9adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a449690>]}
[0m09:22:39.653309 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:22:39.657587 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:22:39.696118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40bccf95-77b6-42eb-b236-0471681f9adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a873990>]}
[0m09:22:39.696676 [info ] [MainThread]: Found 1 model, 477 macros
[0m09:22:39.697023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40bccf95-77b6-42eb-b236-0471681f9adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a665d90>]}
[0m09:22:39.699128 [info ] [MainThread]: 
[0m09:22:39.699681 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:22:39.700146 [info ] [MainThread]: 
[0m09:22:39.700812 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:22:39.701903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m09:22:39.772089 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m09:22:39.772602 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m09:22:39.772948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:22:41.804309 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.031 seconds
[0m09:22:41.809277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now create_estat_db_estat_stg_estat_transformed)
[0m09:22:41.810516 [debug] [ThreadPool]: Creating schema "database: "estat_db"
schema: "estat_stg_estat_transformed"
"
[0m09:22:41.819490 [debug] [ThreadPool]: Using snowflake connection "create_estat_db_estat_stg_estat_transformed"
[0m09:22:41.820187 [debug] [ThreadPool]: On create_estat_db_estat_stg_estat_transformed: create schema if not exists estat_db.estat_stg_estat_transformed
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "create_estat_db_estat_stg_estat_transformed"} */
[0m09:22:41.916359 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdc276-0002-9d3e-0002-73ea000ab06e
[0m09:22:41.917237 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:22:41.918128 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m09:22:41.918747 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:22:41.920259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:22:41.920949 [debug] [MainThread]: Connection 'create_estat_db_estat_stg_estat_transformed' was left open.
[0m09:22:41.921895 [debug] [MainThread]: On create_estat_db_estat_stg_estat_transformed: Close
[0m09:22:42.009658 [info ] [MainThread]: 
[0m09:22:42.010677 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m09:22:42.012331 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:22:42.015679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.658946, "process_in_blocks": "0", "process_kernel_time": 0.728491, "process_mem_max_rss": "146952192", "process_out_blocks": "0", "process_user_time": 3.571037}
[0m09:22:42.016687 [debug] [MainThread]: Command `dbt run` failed at 09:22:42.016470 after 4.66 seconds
[0m09:22:42.017638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8c3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e52a90>]}
[0m09:22:42.018495 [debug] [MainThread]: Flushing usage events
[0m09:22:43.539124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:13.443560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106728610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106781150>]}


============================== 09:27:13.451037 | 89a3849e-b93d-49c6-9773-2ef8fad729c6 ==============================
[0m09:27:13.451037 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:27:13.451808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tthuha236/.dbt', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:27:14.152018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89a3849e-b93d-49c6-9773-2ef8fad729c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107404a90>]}
[0m09:27:14.225732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89a3849e-b93d-49c6-9773-2ef8fad729c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073040d0>]}
[0m09:27:14.227314 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:27:14.456601 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:27:14.621224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:27:14.621947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:27:14.628065 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m09:27:14.655947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89a3849e-b93d-49c6-9773-2ef8fad729c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a0e90>]}
[0m09:27:14.726325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:27:14.728530 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:27:14.746636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89a3849e-b93d-49c6-9773-2ef8fad729c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b5e50>]}
[0m09:27:14.747527 [info ] [MainThread]: Found 1 model, 477 macros
[0m09:27:14.748376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89a3849e-b93d-49c6-9773-2ef8fad729c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067624d0>]}
[0m09:27:14.750949 [info ] [MainThread]: 
[0m09:27:14.751570 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:27:14.751946 [info ] [MainThread]: 
[0m09:27:14.752671 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:27:14.753898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m09:27:14.822032 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m09:27:14.822559 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m09:27:14.823138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:16.531900 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.709 seconds
[0m09:27:16.534600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now create_estat_db_estat_stg_estat_transformed)
[0m09:27:16.535309 [debug] [ThreadPool]: Creating schema "database: "estat_db"
schema: "estat_stg_estat_transformed"
"
[0m09:27:16.541393 [debug] [ThreadPool]: Using snowflake connection "create_estat_db_estat_stg_estat_transformed"
[0m09:27:16.541904 [debug] [ThreadPool]: On create_estat_db_estat_stg_estat_transformed: create schema if not exists estat_db.estat_stg_estat_transformed
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "create_estat_db_estat_stg_estat_transformed"} */
[0m09:27:16.632746 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdc27b-0002-9e28-0002-73ea000af092
[0m09:27:16.633383 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:27:16.633977 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m09:27:16.634371 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:27:16.635370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:16.635822 [debug] [MainThread]: Connection 'create_estat_db_estat_stg_estat_transformed' was left open.
[0m09:27:16.636241 [debug] [MainThread]: On create_estat_db_estat_stg_estat_transformed: Close
[0m09:27:16.965339 [info ] [MainThread]: 
[0m09:27:16.966477 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m09:27:16.967658 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:27:16.970631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.601812, "process_in_blocks": "0", "process_kernel_time": 0.653472, "process_mem_max_rss": "143151104", "process_out_blocks": "0", "process_user_time": 2.56746}
[0m09:27:16.971828 [debug] [MainThread]: Command `dbt run` failed at 09:27:16.971592 after 3.60 seconds
[0m09:27:16.972503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102079cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106799990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106799b90>]}
[0m09:27:16.973060 [debug] [MainThread]: Flushing usage events
[0m09:27:18.735344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:29:36.942891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109b6d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109b4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a26750>]}


============================== 09:29:36.947935 | 3e2b0375-8b2e-4fe2-b555-fee1bc8d562e ==============================
[0m09:29:36.947935 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:29:36.948914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:29:37.396144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e2b0375-8b2e-4fe2-b555-fee1bc8d562e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111654f10>]}
[0m09:29:37.461823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e2b0375-8b2e-4fe2-b555-fee1bc8d562e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032e6d0>]}
[0m09:29:37.462819 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:29:37.654668 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:29:37.744742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:29:37.745470 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense.sql
[0m09:29:37.981898 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m09:29:37.987868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e2b0375-8b2e-4fe2-b555-fee1bc8d562e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11172a610>]}
[0m09:29:38.046420 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:29:38.049094 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:29:38.063089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e2b0375-8b2e-4fe2-b555-fee1bc8d562e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d2c390>]}
[0m09:29:38.063633 [info ] [MainThread]: Found 1 model, 477 macros
[0m09:29:38.063991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e2b0375-8b2e-4fe2-b555-fee1bc8d562e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c418d0>]}
[0m09:29:38.065794 [info ] [MainThread]: 
[0m09:29:38.066308 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:29:38.066733 [info ] [MainThread]: 
[0m09:29:38.067464 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:29:38.068742 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m09:29:38.125356 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m09:29:38.125933 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m09:29:38.126304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:29:39.612451 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.486 seconds
[0m09:29:39.617573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now create_estat_db_estat_stg_estat_transformed)
[0m09:29:39.618678 [debug] [ThreadPool]: Creating schema "database: "estat_db"
schema: "estat_stg_estat_transformed"
"
[0m09:29:39.627905 [debug] [ThreadPool]: Using snowflake connection "create_estat_db_estat_stg_estat_transformed"
[0m09:29:39.628658 [debug] [ThreadPool]: On create_estat_db_estat_stg_estat_transformed: create schema if not exists estat_db.estat_stg_estat_transformed
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "create_estat_db_estat_stg_estat_transformed"} */
[0m09:29:39.736128 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdc27d-0002-9dff-0002-73ea000aa10a
[0m09:29:39.737124 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:29:39.738043 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m09:29:39.738670 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:29:39.740222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:29:39.741085 [debug] [MainThread]: Connection 'create_estat_db_estat_stg_estat_transformed' was left open.
[0m09:29:39.741778 [debug] [MainThread]: On create_estat_db_estat_stg_estat_transformed: Close
[0m09:29:39.877399 [info ] [MainThread]: 
[0m09:29:39.878581 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m09:29:39.880118 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:29:39.883683 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0091999, "process_in_blocks": "0", "process_kernel_time": 0.460383, "process_mem_max_rss": "147353600", "process_out_blocks": "0", "process_user_time": 2.521396}
[0m09:29:39.884924 [debug] [MainThread]: Command `dbt run` failed at 09:29:39.884678 after 3.01 seconds
[0m09:29:39.885820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fce5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d54f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0cb10>]}
[0m09:29:39.886695 [debug] [MainThread]: Flushing usage events
[0m09:29:41.943014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:30:05.490794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a512f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a66ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a66b2d0>]}


============================== 09:30:05.497289 | 787783c8-9a8d-458d-a0f0-559336e1f45d ==============================
[0m09:30:05.497289 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:30:05.498345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'profiles_dir': '/Users/tthuha236/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:30:05.945523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '787783c8-9a8d-458d-a0f0-559336e1f45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb4650>]}
[0m09:30:06.007350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '787783c8-9a8d-458d-a0f0-559336e1f45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b200490>]}
[0m09:30:06.008249 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:30:06.198917 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:30:06.264757 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:30:06.265438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '787783c8-9a8d-458d-a0f0-559336e1f45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f5e710>]}
[0m09:30:07.219642 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m09:30:07.225633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '787783c8-9a8d-458d-a0f0-559336e1f45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b45eb90>]}
[0m09:30:07.284547 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:30:07.286988 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:30:07.302185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '787783c8-9a8d-458d-a0f0-559336e1f45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b899b10>]}
[0m09:30:07.302783 [info ] [MainThread]: Found 1 model, 477 macros
[0m09:30:07.303210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '787783c8-9a8d-458d-a0f0-559336e1f45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7cee50>]}
[0m09:30:07.305271 [info ] [MainThread]: 
[0m09:30:07.305836 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:30:07.306293 [info ] [MainThread]: 
[0m09:30:07.307125 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:30:07.308204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m09:30:07.362826 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m09:30:07.363379 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m09:30:07.363745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:30:08.521132 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.157 seconds
[0m09:30:08.525976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now create_estat_db_estat_stg_ESTAT_TRANSFORMED)
[0m09:30:08.527088 [debug] [ThreadPool]: Creating schema "database: "estat_db"
schema: "estat_stg_ESTAT_TRANSFORMED"
"
[0m09:30:08.536201 [debug] [ThreadPool]: Using snowflake connection "create_estat_db_estat_stg_ESTAT_TRANSFORMED"
[0m09:30:08.536906 [debug] [ThreadPool]: On create_estat_db_estat_stg_ESTAT_TRANSFORMED: create schema if not exists estat_db.estat_stg_ESTAT_TRANSFORMED
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "create_estat_db_estat_stg_ESTAT_TRANSFORMED"} */
[0m09:30:08.668944 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdc27e-0002-9df4-0002-73ea000ad0e6
[0m09:30:08.669983 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:30:08.670898 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m09:30:08.671522 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:30:08.673087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:30:08.673798 [debug] [MainThread]: Connection 'create_estat_db_estat_stg_ESTAT_TRANSFORMED' was left open.
[0m09:30:08.674570 [debug] [MainThread]: On create_estat_db_estat_stg_ESTAT_TRANSFORMED: Close
[0m09:30:08.934206 [info ] [MainThread]: 
[0m09:30:08.935679 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m09:30:08.937326 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:30:08.940680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5306337, "process_in_blocks": "0", "process_kernel_time": 0.460225, "process_mem_max_rss": "146788352", "process_out_blocks": "0", "process_user_time": 3.244744}
[0m09:30:08.941851 [debug] [MainThread]: Command `dbt run` failed at 09:30:08.941608 after 3.53 seconds
[0m09:30:08.942692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f31e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b962850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8def10>]}
[0m09:30:08.943533 [debug] [MainThread]: Flushing usage events
[0m09:30:09.841948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:48.557330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a94090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b06410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b06850>]}


============================== 09:32:48.565385 | 41676560-44e8-492b-8832-ee7e56ec61b0 ==============================
[0m09:32:48.565385 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:32:48.566428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:32:49.349038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41676560-44e8-492b-8832-ee7e56ec61b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148708d0>]}
[0m09:32:49.410507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41676560-44e8-492b-8832-ee7e56ec61b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111db590>]}
[0m09:32:49.412937 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:32:49.628383 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:32:49.697090 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:32:49.697875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '41676560-44e8-492b-8832-ee7e56ec61b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133fa810>]}
[0m09:32:50.733164 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m09:32:50.740087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41676560-44e8-492b-8832-ee7e56ec61b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114851210>]}
[0m09:32:50.803253 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:32:50.806327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:32:50.842333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41676560-44e8-492b-8832-ee7e56ec61b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d90cd0>]}
[0m09:32:50.843017 [info ] [MainThread]: Found 1 model, 477 macros
[0m09:32:50.843429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41676560-44e8-492b-8832-ee7e56ec61b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b31350>]}
[0m09:32:50.845386 [info ] [MainThread]: 
[0m09:32:50.845962 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:32:50.846390 [info ] [MainThread]: 
[0m09:32:50.847145 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:32:50.848247 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m09:32:50.917584 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m09:32:50.918095 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m09:32:50.918450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:52.625017 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.706 seconds
[0m09:32:52.629993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_stg)
[0m09:32:52.650929 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_stg"
[0m09:32:52.651663 [debug] [ThreadPool]: On list_estat_db_estat_stg: show objects in estat_db.estat_stg
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_stg"} */;
[0m09:32:52.732204 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.080 seconds
[0m09:32:52.738645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41676560-44e8-492b-8832-ee7e56ec61b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cf8f90>]}
[0m09:32:52.746534 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m09:32:52.747728 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_stg.fact_expense ...................... [RUN]
[0m09:32:52.748767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_stg, now model.estat_dbt.fact_expense)
[0m09:32:52.749707 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m09:32:52.781551 [debug] [Thread-1 (]: Compilation Error in model fact_expense (models/transformed/fact_expense.sql)
  Required var 'input_schema' not found in config:
  Vars supplied to fact_expense = {}
[0m09:32:52.785624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41676560-44e8-492b-8832-ee7e56ec61b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a61a90>]}
[0m09:32:52.786706 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_stg.fact_expense ............. [[31mERROR[0m in 0.03s]
[0m09:32:52.787672 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m09:32:52.788759 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Compilation Error in model fact_expense (models/transformed/fact_expense.sql)
  Required var 'input_schema' not found in config:
  Vars supplied to fact_expense = {}.
[0m09:32:52.791122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:52.791565 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m09:32:52.792020 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m09:32:53.079454 [info ] [MainThread]: 
[0m09:32:53.080723 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m09:32:53.082510 [debug] [MainThread]: Command end result
[0m09:32:53.114118 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:32:53.116430 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:32:53.125574 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m09:32:53.126063 [info ] [MainThread]: 
[0m09:32:53.126569 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:32:53.126961 [info ] [MainThread]: 
[0m09:32:53.127477 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense.sql)[0m
[0m09:32:53.127971 [error] [MainThread]:   Compilation Error in model fact_expense (models/transformed/fact_expense.sql)
  Required var 'input_schema' not found in config:
  Vars supplied to fact_expense = {}
[0m09:32:53.128339 [info ] [MainThread]: 
[0m09:32:53.128759 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:32:53.130510 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.655018, "process_in_blocks": "0", "process_kernel_time": 0.724053, "process_mem_max_rss": "147185664", "process_out_blocks": "0", "process_user_time": 3.69505}
[0m09:32:53.131138 [debug] [MainThread]: Command `dbt run` failed at 09:32:53.131011 after 4.66 seconds
[0m09:32:53.131657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ad2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2d9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111285890>]}
[0m09:32:53.132040 [debug] [MainThread]: Flushing usage events
[0m09:32:54.837828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:41:42.733700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143b2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144265d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114426d90>]}


============================== 09:41:42.742044 | e5f542e5-9051-4c18-af20-091a4247d3eb ==============================
[0m09:41:42.742044 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:41:42.742978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:41:43.561632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5f542e5-9051-4c18-af20-091a4247d3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150c3090>]}
[0m09:41:43.622107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5f542e5-9051-4c18-af20-091a4247d3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fbc0d0>]}
[0m09:41:43.623732 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:41:43.829042 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:41:43.898525 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:41:43.899386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e5f542e5-9051-4c18-af20-091a4247d3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d1e750>]}
[0m09:41:44.904633 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m09:41:44.911091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5f542e5-9051-4c18-af20-091a4247d3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151f51d0>]}
[0m09:41:44.973816 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:41:44.978068 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:41:45.012778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5f542e5-9051-4c18-af20-091a4247d3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115667550>]}
[0m09:41:45.013348 [info ] [MainThread]: Found 1 model, 477 macros
[0m09:41:45.013717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5f542e5-9051-4c18-af20-091a4247d3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115443c10>]}
[0m09:41:45.015457 [info ] [MainThread]: 
[0m09:41:45.015976 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:41:45.016403 [info ] [MainThread]: 
[0m09:41:45.017158 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:41:45.018232 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m09:41:45.092079 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m09:41:45.092655 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m09:41:45.093215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:46.994291 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.901 seconds
[0m09:41:46.998890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_stg)
[0m09:41:47.019016 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_stg"
[0m09:41:47.019541 [debug] [ThreadPool]: On list_estat_db_estat_stg: show objects in estat_db.estat_stg
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_stg"} */;
[0m09:41:47.190617 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.170 seconds
[0m09:41:47.196963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5f542e5-9051-4c18-af20-091a4247d3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1166644d0>]}
[0m09:41:47.202569 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m09:41:47.203637 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_stg.fact_expense ...................... [RUN]
[0m09:41:47.204537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_stg, now model.estat_dbt.fact_expense)
[0m09:41:47.205241 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m09:41:47.232613 [debug] [Thread-1 (]: Compilation Error in model fact_expense (models/transformed/fact_expense.sql)
  'vars' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:47.236106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5f542e5-9051-4c18-af20-091a4247d3eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154a1950>]}
[0m09:41:47.236999 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_stg.fact_expense ............. [[31mERROR[0m in 0.03s]
[0m09:41:47.237717 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m09:41:47.238296 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Compilation Error in model fact_expense (models/transformed/fact_expense.sql)
  'vars' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:41:47.240607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:47.241351 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m09:41:47.241827 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m09:41:47.394250 [info ] [MainThread]: 
[0m09:41:47.395382 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m09:41:47.397134 [debug] [MainThread]: Command end result
[0m09:41:47.431538 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:41:47.433659 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:41:47.439663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m09:41:47.440234 [info ] [MainThread]: 
[0m09:41:47.440754 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:41:47.441328 [info ] [MainThread]: 
[0m09:41:47.441956 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense.sql)[0m
[0m09:41:47.442485 [error] [MainThread]:   Compilation Error in model fact_expense (models/transformed/fact_expense.sql)
  'vars' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:47.442930 [info ] [MainThread]: 
[0m09:41:47.443435 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:41:47.445126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.799049, "process_in_blocks": "0", "process_kernel_time": 0.769824, "process_mem_max_rss": "146763776", "process_out_blocks": "0", "process_user_time": 3.769487}
[0m09:41:47.445860 [debug] [MainThread]: Command `dbt run` failed at 09:41:47.445716 after 4.80 seconds
[0m09:41:47.446314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114411ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcede10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc49550>]}
[0m09:41:47.446719 [debug] [MainThread]: Flushing usage events
[0m09:41:49.091775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:42:41.280547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f328d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa71d0>]}


============================== 09:42:41.285359 | 6b4ea742-2f5f-4e80-8ec5-aae784726f76 ==============================
[0m09:42:41.285359 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:42:41.286108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'profiles_dir': '/Users/tthuha236/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:42:41.727999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b4ea742-2f5f-4e80-8ec5-aae784726f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2d1d0>]}
[0m09:42:41.793370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b4ea742-2f5f-4e80-8ec5-aae784726f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3c510>]}
[0m09:42:41.794287 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:42:41.986396 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:42:42.066386 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:42:42.067187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b4ea742-2f5f-4e80-8ec5-aae784726f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689a810>]}
[0m09:42:43.141827 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m09:42:43.147802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b4ea742-2f5f-4e80-8ec5-aae784726f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a5810>]}
[0m09:42:43.205214 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:42:43.207359 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:42:43.221959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b4ea742-2f5f-4e80-8ec5-aae784726f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082999d0>]}
[0m09:42:43.222696 [info ] [MainThread]: Found 1 model, 477 macros
[0m09:42:43.223159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b4ea742-2f5f-4e80-8ec5-aae784726f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822da10>]}
[0m09:42:43.224915 [info ] [MainThread]: 
[0m09:42:43.225562 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:42:43.226046 [info ] [MainThread]: 
[0m09:42:43.226811 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:42:43.227957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m09:42:43.282612 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m09:42:43.283039 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m09:42:43.283347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:44.074679 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.791 seconds
[0m09:42:44.079504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now create_estat_db_estat_stg_estat_transformed)
[0m09:42:44.080597 [debug] [ThreadPool]: Creating schema "database: "estat_db"
schema: "estat_stg_estat_transformed"
"
[0m09:42:44.089497 [debug] [ThreadPool]: Using snowflake connection "create_estat_db_estat_stg_estat_transformed"
[0m09:42:44.090210 [debug] [ThreadPool]: On create_estat_db_estat_stg_estat_transformed: create schema if not exists estat_db.estat_stg_estat_transformed
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "create_estat_db_estat_stg_estat_transformed"} */
[0m09:42:44.222293 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdc28a-0002-9d43-0002-73ea000a449e
[0m09:42:44.223167 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:42:44.224056 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m09:42:44.224678 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:42:44.226207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:44.226802 [debug] [MainThread]: Connection 'create_estat_db_estat_stg_estat_transformed' was left open.
[0m09:42:44.227333 [debug] [MainThread]: On create_estat_db_estat_stg_estat_transformed: Close
[0m09:42:44.466539 [info ] [MainThread]: 
[0m09:42:44.467476 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m09:42:44.468726 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:42:44.471509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2598784, "process_in_blocks": "0", "process_kernel_time": 0.475321, "process_mem_max_rss": "146870272", "process_out_blocks": "0", "process_user_time": 3.385845}
[0m09:42:44.472518 [debug] [MainThread]: Command `dbt run` failed at 09:42:44.472294 after 3.26 seconds
[0m09:42:44.473278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10286de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027ca910>]}
[0m09:42:44.474021 [debug] [MainThread]: Flushing usage events
[0m09:42:45.201870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:47.787787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a4f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1eb90>]}


============================== 09:49:47.795992 | 07da5af0-82f4-43f7-9947-11db49eef33a ==============================
[0m09:49:47.795992 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:49:47.797038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:49:48.622441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07da5af0-82f4-43f7-9947-11db49eef33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10255c790>]}
[0m09:49:48.688969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07da5af0-82f4-43f7-9947-11db49eef33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593c050>]}
[0m09:49:48.690691 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:49:48.898132 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:49:49.064816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:49:49.065518 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense.sql
[0m09:49:49.313074 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m09:49:49.319008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07da5af0-82f4-43f7-9947-11db49eef33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f38250>]}
[0m09:49:49.381368 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:49:49.384909 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:49:49.422547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07da5af0-82f4-43f7-9947-11db49eef33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee09d0>]}
[0m09:49:49.423127 [info ] [MainThread]: Found 1 model, 477 macros
[0m09:49:49.423507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07da5af0-82f4-43f7-9947-11db49eef33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b9810>]}
[0m09:49:49.425698 [info ] [MainThread]: 
[0m09:49:49.426286 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:49:49.426784 [info ] [MainThread]: 
[0m09:49:49.427542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:49:49.428773 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m09:49:49.500667 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m09:49:49.501109 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m09:49:49.501412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:50.731844 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.230 seconds
[0m09:49:50.736821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now create_estat_db_estat_stg_estat_transformed)
[0m09:49:50.738356 [debug] [ThreadPool]: Creating schema "database: "estat_db"
schema: "estat_stg_estat_transformed"
"
[0m09:49:50.747602 [debug] [ThreadPool]: Using snowflake connection "create_estat_db_estat_stg_estat_transformed"
[0m09:49:50.748353 [debug] [ThreadPool]: On create_estat_db_estat_stg_estat_transformed: create schema if not exists estat_db.estat_stg_estat_transformed
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "create_estat_db_estat_stg_estat_transformed"} */
[0m09:49:50.854122 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bdc291-0002-9dff-0002-73ea000aa152
[0m09:49:50.854765 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:49:50.855430 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m09:49:50.855879 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:49:50.856979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:50.857493 [debug] [MainThread]: Connection 'create_estat_db_estat_stg_estat_transformed' was left open.
[0m09:49:50.857954 [debug] [MainThread]: On create_estat_db_estat_stg_estat_transformed: Close
[0m09:49:50.946076 [info ] [MainThread]: 
[0m09:49:50.947245 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m09:49:50.948705 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'ESTAT_DB'
[0m09:49:50.952823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2446928, "process_in_blocks": "0", "process_kernel_time": 0.748526, "process_mem_max_rss": "146677760", "process_out_blocks": "0", "process_user_time": 2.890813}
[0m09:49:50.954032 [debug] [MainThread]: Command `dbt run` failed at 09:49:50.953782 after 3.25 seconds
[0m09:49:50.954904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100599dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cad110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cae890>]}
[0m09:49:50.955726 [debug] [MainThread]: Flushing usage events
[0m09:49:53.030203 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:56:47.468885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6a9d0>]}


============================== 09:56:47.476461 | fe9ebc12-baac-4439-bc31-dd6f228779da ==============================
[0m09:56:47.476461 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:56:47.477259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'profiles_dir': '/Users/tthuha236/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:56:48.314820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe9ebc12-baac-4439-bc31-dd6f228779da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087775d0>]}
[0m09:56:48.385200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe9ebc12-baac-4439-bc31-dd6f228779da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108677fd0>]}
[0m09:56:48.386789 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:56:48.616061 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:56:48.779880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:56:48.780526 [debug] [MainThread]: Partial parsing: added file: estat_dbt://macros/generate_schema_name.sql
[0m09:56:48.783069 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m09:56:49.733140 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.estat_dbt.mart
[0m09:56:49.739258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe9ebc12-baac-4439-bc31-dd6f228779da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fa7d0>]}
[0m09:56:49.801826 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:56:49.807153 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:56:49.844858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe9ebc12-baac-4439-bc31-dd6f228779da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b44490>]}
[0m09:56:49.845472 [info ] [MainThread]: Found 1 model, 478 macros
[0m09:56:49.845931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe9ebc12-baac-4439-bc31-dd6f228779da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2f350>]}
[0m09:56:49.848016 [info ] [MainThread]: 
[0m09:56:49.848617 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:56:49.849230 [info ] [MainThread]: 
[0m09:56:49.850044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:56:49.851385 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m09:56:49.921896 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m09:56:49.922338 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m09:56:49.922667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:51.323363 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.401 seconds
[0m09:56:51.329157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m09:56:51.351235 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m09:56:51.351922 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m09:56:51.440301 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.088 seconds
[0m09:56:51.444841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe9ebc12-baac-4439-bc31-dd6f228779da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087dddd0>]}
[0m09:56:51.453941 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m09:56:51.455216 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m09:56:51.533874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m09:56:51.534412 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m09:56:51.542449 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m09:56:51.546482 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m09:56:51.624851 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m09:56:51.626285 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m09:56:51.626789 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace transient table estat_db.estat_transformed.fact_expense
    
    
    
    as (

WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg
)
SELECT 
    CATEGORY_CD,
    AMOUNT, 
    AREA_CD, 
    YEAR,
    MONTH,
    CURRENT_TIMESTAMP() as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m09:56:52.940781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.313 seconds
[0m09:56:52.958157 [debug] [Thread-1 (]: Applying DROP to: estat_db.estat_transformed.fact_expense__dbt_tmp
[0m09:56:52.970178 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m09:56:52.970820 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: drop view if exists estat_db.estat_transformed.fact_expense__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m09:56:53.019637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.048 seconds
[0m09:56:53.054074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe9ebc12-baac-4439-bc31-dd6f228779da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c30a50>]}
[0m09:56:53.054938 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model estat_transformed.fact_expense ......... [[32mSUCCESS 1[0m in 1.60s]
[0m09:56:53.055617 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m09:56:53.057548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:53.058086 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m09:56:53.058524 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m09:56:53.317720 [info ] [MainThread]: 
[0m09:56:53.319167 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m09:56:53.321159 [debug] [MainThread]: Command end result
[0m09:56:53.357175 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m09:56:53.359246 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m09:56:53.365232 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m09:56:53.365801 [info ] [MainThread]: 
[0m09:56:53.366315 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:56:53.366747 [info ] [MainThread]: 
[0m09:56:53.367491 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m09:56:53.369221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.980128, "process_in_blocks": "0", "process_kernel_time": 0.783847, "process_mem_max_rss": "147427328", "process_out_blocks": "0", "process_user_time": 3.892553}
[0m09:56:53.369987 [debug] [MainThread]: Command `dbt run` succeeded at 09:56:53.369810 after 5.98 seconds
[0m09:56:53.370563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032e9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103189f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103242950>]}
[0m09:56:53.371093 [debug] [MainThread]: Flushing usage events
[0m09:56:54.620831 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:53.251404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109012850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109012cd0>]}


============================== 15:26:53.260291 | 526ed14c-eff4-4e70-b271-00eb4abf0651 ==============================
[0m15:26:53.260291 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:26:53.261304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'profiles_dir': '/Users/tthuha236/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:54.091348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '526ed14c-eff4-4e70-b271-00eb4abf0651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc1b10>]}
[0m15:26:54.167638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '526ed14c-eff4-4e70-b271-00eb4abf0651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b6fad0>]}
[0m15:26:54.169616 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:26:54.389096 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:26:54.459143 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:26:54.459844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '526ed14c-eff4-4e70-b271-00eb4abf0651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089228d0>]}
[0m15:26:55.702726 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.vars
- models.estat_dbt.mart
[0m15:26:55.714203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '526ed14c-eff4-4e70-b271-00eb4abf0651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d090d0>]}
[0m15:26:55.864842 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:26:55.868319 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:26:55.906867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '526ed14c-eff4-4e70-b271-00eb4abf0651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2be310>]}
[0m15:26:55.907688 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m15:26:55.908289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526ed14c-eff4-4e70-b271-00eb4abf0651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107081fd0>]}
[0m15:26:55.910340 [info ] [MainThread]: 
[0m15:26:55.910854 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:26:55.911452 [info ] [MainThread]: 
[0m15:26:55.912158 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:26:55.913144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m15:26:55.988398 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m15:26:55.988844 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m15:26:55.989148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:57.447278 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.458 seconds
[0m15:26:57.452215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m15:26:57.472464 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m15:26:57.473081 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m15:26:57.832386 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.359 seconds
[0m15:26:57.837395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526ed14c-eff4-4e70-b271-00eb4abf0651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24cc50>]}
[0m15:26:57.844337 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m15:26:57.845565 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m15:26:57.846843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m15:26:57.847747 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m15:26:57.862183 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m15:26:57.863330 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m15:26:57.933497 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m15:26:57.935156 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:26:57.935577 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace transient table estat_db.estat_transformed.fact_expense
    
    
    
    as (WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg
)
SELECT 
    CATEGORY_CD,
    AMOUNT, 
    AREA_CD, 
    YEAR,
    MONTH,
    CURRENT_TIMESTAMP() as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table
    )

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m15:26:59.247127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.311 seconds
[0m15:26:59.257152 [debug] [Thread-1 (]: Applying DROP to: estat_db.estat_transformed.fact_expense__dbt_tmp
[0m15:26:59.265796 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:26:59.266363 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: drop view if exists estat_db.estat_transformed.fact_expense__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m15:26:59.413694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m15:26:59.449312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526ed14c-eff4-4e70-b271-00eb4abf0651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b339150>]}
[0m15:26:59.450621 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model estat_transformed.fact_expense ......... [[32mSUCCESS 1[0m in 1.60s]
[0m15:26:59.451537 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m15:26:59.453115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:59.453526 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m15:26:59.453876 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m15:26:59.597931 [info ] [MainThread]: 
[0m15:26:59.599535 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m15:26:59.601888 [debug] [MainThread]: Command end result
[0m15:26:59.638403 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:26:59.641407 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:26:59.647535 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m15:26:59.648012 [info ] [MainThread]: 
[0m15:26:59.648479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:59.648946 [info ] [MainThread]: 
[0m15:26:59.649661 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:26:59.651641 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4832892, "process_in_blocks": "0", "process_kernel_time": 0.78028, "process_mem_max_rss": "147976192", "process_out_blocks": "0", "process_user_time": 4.078305}
[0m15:26:59.652282 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:59.652161 after 6.48 seconds
[0m15:26:59.652708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108979610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104791f90>]}
[0m15:26:59.653132 [debug] [MainThread]: Flushing usage events
[0m15:27:01.648171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:17.863386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcc0e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd32350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd32b10>]}


============================== 15:45:17.871813 | 7ff21dd2-4adc-41fe-85b5-0328fff04508 ==============================
[0m15:45:17.871813 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:45:17.872662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:45:18.678162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ff21dd2-4adc-41fe-85b5-0328fff04508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea288d0>]}
[0m15:45:18.747339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ff21dd2-4adc-41fe-85b5-0328fff04508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e950290>]}
[0m15:45:18.749202 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:45:18.959834 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:45:19.145002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:45:19.145832 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense/schema.yml
[0m15:45:19.146222 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense/fact_expense.sql
[0m15:45:19.477114 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.mart
- models.estat_dbt.vars
[0m15:45:19.494205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ff21dd2-4adc-41fe-85b5-0328fff04508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef7f590>]}
[0m15:45:19.594156 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:45:19.597790 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:45:19.631901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ff21dd2-4adc-41fe-85b5-0328fff04508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c47a850>]}
[0m15:45:19.632562 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m15:45:19.633043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ff21dd2-4adc-41fe-85b5-0328fff04508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec98fd0>]}
[0m15:45:19.635184 [info ] [MainThread]: 
[0m15:45:19.635856 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:45:19.636455 [info ] [MainThread]: 
[0m15:45:19.637471 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:19.638772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m15:45:19.722106 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m15:45:19.722628 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m15:45:19.723014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:21.633509 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.910 seconds
[0m15:45:21.641559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m15:45:21.662866 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m15:45:21.663465 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m15:45:21.837767 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.174 seconds
[0m15:45:21.844447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ff21dd2-4adc-41fe-85b5-0328fff04508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f08f910>]}
[0m15:45:21.851288 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m15:45:21.852394 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m15:45:21.853768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m15:45:21.854800 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m15:45:21.870109 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m15:45:21.871141 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m15:45:21.939453 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:45:21.940017 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg
)
SELECT 
    category_cd,
    amount, 
    area_cd, 
    year,
    month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > estat_db.estat_transformed.fact_expense.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m15:45:22.046481 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc3f5-0002-9cc8-0002-73ea0009adfa
[0m15:45:22.047289 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 4 unexpected 'CURRENT_TIMESTAMP'.
[0m15:45:22.054358 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 4 unexpected 'CURRENT_TIMESTAMP'.
[0m15:45:22.057681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ff21dd2-4adc-41fe-85b5-0328fff04508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110066950>]}
[0m15:45:22.058991 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_transformed.fact_expense ..... [[31mERROR[0m in 0.20s]
[0m15:45:22.059802 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m15:45:22.060696 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 4 unexpected 'CURRENT_TIMESTAMP'..
[0m15:45:22.063284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:22.063842 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m15:45:22.064306 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m15:45:22.250146 [info ] [MainThread]: 
[0m15:45:22.251402 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m15:45:22.253342 [debug] [MainThread]: Command end result
[0m15:45:22.284954 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:45:22.287474 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:45:22.294291 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m15:45:22.294754 [info ] [MainThread]: 
[0m15:45:22.295310 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:45:22.296100 [info ] [MainThread]: 
[0m15:45:22.297031 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense/fact_expense.sql)[0m
[0m15:45:22.297762 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 4 unexpected 'CURRENT_TIMESTAMP'.
[0m15:45:22.298204 [info ] [MainThread]: 
[0m15:45:22.298916 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m15:45:22.299387 [info ] [MainThread]: 
[0m15:45:22.299909 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:45:22.301788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.5201507, "process_in_blocks": "0", "process_kernel_time": 0.789262, "process_mem_max_rss": "151629824", "process_out_blocks": "0", "process_user_time": 3.215277}
[0m15:45:22.302403 [debug] [MainThread]: Command `dbt run` failed at 15:45:22.302286 after 4.52 seconds
[0m15:45:22.302974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b1d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef90d90>]}
[0m15:45:22.303375 [debug] [MainThread]: Flushing usage events
[0m15:45:23.802967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:53.414678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109066a90>]}


============================== 15:45:53.419527 | 3a46131c-0059-44f2-baa7-b1dbffe6d9f9 ==============================
[0m15:45:53.419527 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:45:53.420265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tthuha236/.dbt', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:45:53.893955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a46131c-0059-44f2-baa7-b1dbffe6d9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da4790>]}
[0m15:45:53.960605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a46131c-0059-44f2-baa7-b1dbffe6d9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c73f50>]}
[0m15:45:53.961534 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:45:54.157166 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:45:54.277828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:54.278641 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense/fact_expense.sql
[0m15:45:54.609698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.vars
- models.estat_dbt.mart
[0m15:45:54.626387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a46131c-0059-44f2-baa7-b1dbffe6d9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d73810>]}
[0m15:45:54.711354 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:45:54.714181 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:45:54.732115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a46131c-0059-44f2-baa7-b1dbffe6d9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a343e90>]}
[0m15:45:54.732744 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m15:45:54.733141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a46131c-0059-44f2-baa7-b1dbffe6d9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c3e50>]}
[0m15:45:54.735170 [info ] [MainThread]: 
[0m15:45:54.735714 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:45:54.736203 [info ] [MainThread]: 
[0m15:45:54.737022 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:54.738175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m15:45:54.793295 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m15:45:54.793736 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m15:45:54.794052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:55.595350 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.801 seconds
[0m15:45:55.601005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m15:45:55.622336 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m15:45:55.623151 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m15:45:55.868384 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.245 seconds
[0m15:45:55.874812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a46131c-0059-44f2-baa7-b1dbffe6d9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a28a190>]}
[0m15:45:55.880084 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m15:45:55.881172 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m15:45:55.882070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m15:45:55.882754 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m15:45:55.899002 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m15:45:55.900109 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m15:45:55.960675 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:45:55.961345 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg
)
SELECT 
    category_cd,
    amount, 
    area_cd, 
    year,
    month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > estat_db.estat_transformed.fact_expense.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m15:45:56.248086 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc3f5-0002-9e28-0002-73ea000af14a
[0m15:45:56.249054 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'CATEGORY_CD'
[0m15:45:56.255333 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CATEGORY_CD'
[0m15:45:56.258151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a46131c-0059-44f2-baa7-b1dbffe6d9f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b513f90>]}
[0m15:45:56.259495 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_transformed.fact_expense ..... [[31mERROR[0m in 0.37s]
[0m15:45:56.260833 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m15:45:56.261709 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CATEGORY_CD'.
[0m15:45:56.264676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:56.265537 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m15:45:56.266174 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m15:45:56.349692 [info ] [MainThread]: 
[0m15:45:56.350851 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m15:45:56.352786 [debug] [MainThread]: Command end result
[0m15:45:56.386576 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:45:56.388600 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:45:56.394781 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m15:45:56.395373 [info ] [MainThread]: 
[0m15:45:56.395894 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:45:56.396326 [info ] [MainThread]: 
[0m15:45:56.396789 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense/fact_expense.sql)[0m
[0m15:45:56.397483 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CATEGORY_CD'
[0m15:45:56.398001 [info ] [MainThread]: 
[0m15:45:56.398539 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m15:45:56.399029 [info ] [MainThread]: 
[0m15:45:56.399468 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:45:56.401235 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0591385, "process_in_blocks": "0", "process_kernel_time": 0.486677, "process_mem_max_rss": "151052288", "process_out_blocks": "0", "process_user_time": 2.864111}
[0m15:45:56.401854 [debug] [MainThread]: Command `dbt run` failed at 15:45:56.401742 after 3.06 seconds
[0m15:45:56.402300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e1dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a31a150>]}
[0m15:45:56.402679 [debug] [MainThread]: Flushing usage events
[0m15:45:57.287727 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:30.361198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f34310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa6910>]}


============================== 15:46:30.366052 | da5dfeca-5f66-452e-afb4-74941ce7e8d5 ==============================
[0m15:46:30.366052 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:46:30.366790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:46:30.830714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da5dfeca-5f66-452e-afb4-74941ce7e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c69090>]}
[0m15:46:30.904852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da5dfeca-5f66-452e-afb4-74941ce7e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b03b90>]}
[0m15:46:30.905998 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:46:31.112275 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:46:31.227043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:46:31.227819 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense/fact_expense.sql
[0m15:46:31.552105 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.vars
- models.estat_dbt.mart
[0m15:46:31.570763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da5dfeca-5f66-452e-afb4-74941ce7e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eca110>]}
[0m15:46:31.643313 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:46:31.645524 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:46:31.659155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da5dfeca-5f66-452e-afb4-74941ce7e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c77490>]}
[0m15:46:31.660036 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m15:46:31.660463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da5dfeca-5f66-452e-afb4-74941ce7e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b7f90>]}
[0m15:46:31.662290 [info ] [MainThread]: 
[0m15:46:31.662833 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:46:31.663390 [info ] [MainThread]: 
[0m15:46:31.664151 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:46:31.665355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m15:46:31.725826 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m15:46:31.726267 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m15:46:31.726581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:32.945344 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.219 seconds
[0m15:46:32.950651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m15:46:32.971548 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m15:46:32.972136 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m15:46:33.089713 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.117 seconds
[0m15:46:33.095313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da5dfeca-5f66-452e-afb4-74941ce7e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ecbfd0>]}
[0m15:46:33.100033 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m15:46:33.101048 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m15:46:33.101916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m15:46:33.102693 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m15:46:33.122228 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m15:46:33.123328 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m15:46:33.190592 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:46:33.191278 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > estat_db.estat_transformed.fact_expense.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m15:46:33.341743 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc3f6-0002-9cc8-0002-73ea0009adfe
[0m15:46:33.342708 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 26 at position 47
invalid identifier 'ESTAT_DB.ESTAT_TRANSFORMED.FACT_EXPENSE.UPDATED_AT'
[0m15:46:33.349000 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  000904 (42000): SQL compilation error: error line 26 at position 47
  invalid identifier 'ESTAT_DB.ESTAT_TRANSFORMED.FACT_EXPENSE.UPDATED_AT'
[0m15:46:33.352021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5dfeca-5f66-452e-afb4-74941ce7e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3e0050>]}
[0m15:46:33.353337 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_transformed.fact_expense ..... [[31mERROR[0m in 0.25s]
[0m15:46:33.354260 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m15:46:33.355114 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  000904 (42000): SQL compilation error: error line 26 at position 47
  invalid identifier 'ESTAT_DB.ESTAT_TRANSFORMED.FACT_EXPENSE.UPDATED_AT'.
[0m15:46:33.357960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:33.358673 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m15:46:33.359260 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m15:46:33.525947 [info ] [MainThread]: 
[0m15:46:33.527134 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m15:46:33.529165 [debug] [MainThread]: Command end result
[0m15:46:33.561440 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:46:33.563485 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:46:33.569534 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m15:46:33.569956 [info ] [MainThread]: 
[0m15:46:33.570390 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:46:33.570800 [info ] [MainThread]: 
[0m15:46:33.571450 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense/fact_expense.sql)[0m
[0m15:46:33.572119 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  000904 (42000): SQL compilation error: error line 26 at position 47
  invalid identifier 'ESTAT_DB.ESTAT_TRANSFORMED.FACT_EXPENSE.UPDATED_AT'
[0m15:46:33.572561 [info ] [MainThread]: 
[0m15:46:33.573000 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m15:46:33.573441 [info ] [MainThread]: 
[0m15:46:33.573912 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:46:33.575765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.284411, "process_in_blocks": "0", "process_kernel_time": 0.482713, "process_mem_max_rss": "151437312", "process_out_blocks": "0", "process_user_time": 2.8884}
[0m15:46:33.576476 [debug] [MainThread]: Command `dbt run` failed at 15:46:33.576324 after 3.29 seconds
[0m15:46:33.577012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104885cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2cf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047de910>]}
[0m15:46:33.577445 [debug] [MainThread]: Flushing usage events
[0m15:46:34.607024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:29.029211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11440a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114469110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11447dd50>]}


============================== 15:48:29.037096 | b212362b-70a5-46a9-a655-09d873e134d8 ==============================
[0m15:48:29.037096 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:48:29.038059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:48:29.730951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b212362b-70a5-46a9-a655-09d873e134d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114469890>]}
[0m15:48:29.795388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b212362b-70a5-46a9-a655-09d873e134d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150141d0>]}
[0m15:48:29.797382 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:48:30.016583 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:48:30.188838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:48:30.189584 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense/fact_expense.sql
[0m15:48:30.522266 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.vars
- models.estat_dbt.mart
[0m15:48:30.539481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b212362b-70a5-46a9-a655-09d873e134d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155f5510>]}
[0m15:48:30.613682 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:48:30.617550 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:48:30.650099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b212362b-70a5-46a9-a655-09d873e134d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157762d0>]}
[0m15:48:30.650648 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m15:48:30.651030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b212362b-70a5-46a9-a655-09d873e134d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11575b010>]}
[0m15:48:30.653070 [info ] [MainThread]: 
[0m15:48:30.653633 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:48:30.654050 [info ] [MainThread]: 
[0m15:48:30.654683 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:48:30.655874 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m15:48:30.725086 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m15:48:30.725566 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m15:48:30.725877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:32.880643 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.155 seconds
[0m15:48:32.886257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m15:48:32.906851 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m15:48:32.907467 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m15:48:33.275956 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.368 seconds
[0m15:48:33.281686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b212362b-70a5-46a9-a655-09d873e134d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11560ab50>]}
[0m15:48:33.289510 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m15:48:33.290800 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m15:48:33.291920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m15:48:33.292820 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m15:48:33.309582 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m15:48:33.311766 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m15:48:33.373471 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:48:33.373996 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > t.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m15:48:33.798892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m15:48:33.816472 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:48:33.817266 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m15:48:33.925640 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.108 seconds
[0m15:48:33.934167 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:48:33.935080 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m15:48:34.054161 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.118 seconds
[0m15:48:34.071168 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:48:34.071985 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table "ESTAT_DB"."ESTAT_TRANSFORMED"."FACT_EXPENSE"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m15:48:34.155947 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.083 seconds
[0m15:48:34.204745 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m15:48:34.207109 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:48:34.207567 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m15:48:34.319281 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m15:48:34.320382 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:48:34.321298 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: merge into estat_db.estat_transformed.fact_expense as DBT_INTERNAL_DEST
        using estat_db.estat_transformed.fact_expense__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.category_id = DBT_INTERNAL_DEST.category_id
                ) and (
                    DBT_INTERNAL_SOURCE.area_cd = DBT_INTERNAL_DEST.area_cd
                ) and (
                    DBT_INTERNAL_SOURCE.year = DBT_INTERNAL_DEST.year
                ) and (
                    DBT_INTERNAL_SOURCE.month = DBT_INTERNAL_DEST.month
                )

    
    when matched then update set
        "CATEGORY_CD" = DBT_INTERNAL_SOURCE."CATEGORY_CD","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","AREA_CD" = DBT_INTERNAL_SOURCE."AREA_CD","YEAR" = DBT_INTERNAL_SOURCE."YEAR","MONTH" = DBT_INTERNAL_SOURCE."MONTH","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")
    values
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")


/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m15:48:34.611852 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc3f8-0002-9df4-0002-73ea000ad19e
[0m15:48:34.612858 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 20
invalid identifier 'DBT_INTERNAL_SOURCE.CATEGORY_ID'
[0m15:48:34.620744 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.CATEGORY_ID'
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m15:48:34.624060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b212362b-70a5-46a9-a655-09d873e134d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167b49d0>]}
[0m15:48:34.625188 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_transformed.fact_expense ..... [[31mERROR[0m in 1.33s]
[0m15:48:34.626613 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m15:48:34.627958 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.CATEGORY_ID'
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql.
[0m15:48:34.631110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:34.631968 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m15:48:34.632571 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m15:48:34.731465 [info ] [MainThread]: 
[0m15:48:34.732638 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m15:48:34.734617 [debug] [MainThread]: Command end result
[0m15:48:34.769901 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:48:34.773349 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:48:34.779655 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m15:48:34.780192 [info ] [MainThread]: 
[0m15:48:34.780746 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:48:34.781248 [info ] [MainThread]: 
[0m15:48:34.781858 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense/fact_expense.sql)[0m
[0m15:48:34.782256 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.CATEGORY_ID'
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m15:48:34.782565 [info ] [MainThread]: 
[0m15:48:34.783085 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m15:48:34.783444 [info ] [MainThread]: 
[0m15:48:34.783891 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:48:34.785923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.8365493, "process_in_blocks": "0", "process_kernel_time": 0.719185, "process_mem_max_rss": "151220224", "process_out_blocks": "0", "process_user_time": 3.230397}
[0m15:48:34.786564 [debug] [MainThread]: Command `dbt run` failed at 15:48:34.786433 after 5.84 seconds
[0m15:48:34.787125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114469ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd45e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fca2a90>]}
[0m15:48:34.787599 [debug] [MainThread]: Flushing usage events
[0m15:48:36.435338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:05.910501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c18450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c71410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c8ab10>]}


============================== 15:50:05.915639 | 205e76db-812f-40cf-a759-ff429631d1ee ==============================
[0m15:50:05.915639 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:50:05.916447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:50:06.364996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '205e76db-812f-40cf-a759-ff429631d1ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11282bad0>]}
[0m15:50:06.431857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '205e76db-812f-40cf-a759-ff429631d1ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e3f50>]}
[0m15:50:06.432902 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:50:06.625772 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:50:06.743866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:06.745011 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense/schema.yml
[0m15:50:07.074601 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.mart
- models.estat_dbt.vars
[0m15:50:07.090713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '205e76db-812f-40cf-a759-ff429631d1ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fdcc90>]}
[0m15:50:07.163669 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:50:07.166358 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:50:07.181422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '205e76db-812f-40cf-a759-ff429631d1ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f485d0>]}
[0m15:50:07.182052 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m15:50:07.182491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '205e76db-812f-40cf-a759-ff429631d1ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f2d710>]}
[0m15:50:07.184382 [info ] [MainThread]: 
[0m15:50:07.184890 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m15:50:07.185407 [info ] [MainThread]: 
[0m15:50:07.186213 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:50:07.187440 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m15:50:07.243032 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m15:50:07.243489 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m15:50:07.243849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:08.298143 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.054 seconds
[0m15:50:08.304212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m15:50:08.326915 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m15:50:08.327442 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m15:50:08.451657 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m15:50:08.457243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '205e76db-812f-40cf-a759-ff429631d1ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e90090>]}
[0m15:50:08.462308 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m15:50:08.463440 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m15:50:08.464340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m15:50:08.465095 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m15:50:08.481796 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m15:50:08.482779 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m15:50:08.547904 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:50:08.548518 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > t.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m15:50:09.004507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.455 seconds
[0m15:50:09.022183 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:50:09.022919 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m15:50:09.146052 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.122 seconds
[0m15:50:09.154720 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:50:09.155652 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m15:50:09.240043 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.083 seconds
[0m15:50:09.256397 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:50:09.257261 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table "ESTAT_DB"."ESTAT_TRANSFORMED"."FACT_EXPENSE"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m15:50:09.335887 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.078 seconds
[0m15:50:09.386915 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m15:50:09.389005 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:50:09.389478 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m15:50:09.572218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m15:50:09.573916 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:50:09.575372 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: merge into estat_db.estat_transformed.fact_expense as DBT_INTERNAL_DEST
        using estat_db.estat_transformed.fact_expense__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.category_cd = DBT_INTERNAL_DEST.category_cd
                ) and (
                    DBT_INTERNAL_SOURCE.area_cd = DBT_INTERNAL_DEST.area_cd
                ) and (
                    DBT_INTERNAL_SOURCE.year = DBT_INTERNAL_DEST.year
                ) and (
                    DBT_INTERNAL_SOURCE.month = DBT_INTERNAL_DEST.month
                )

    
    when matched then update set
        "CATEGORY_CD" = DBT_INTERNAL_SOURCE."CATEGORY_CD","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","AREA_CD" = DBT_INTERNAL_SOURCE."AREA_CD","YEAR" = DBT_INTERNAL_SOURCE."YEAR","MONTH" = DBT_INTERNAL_SOURCE."MONTH","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")
    values
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")


/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m15:50:11.046389 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.469 seconds
[0m15:50:11.047802 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:50:11.048798 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m15:50:11.314701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m15:50:11.332117 [debug] [Thread-1 (]: Applying DROP to: estat_db.estat_transformed.fact_expense__dbt_tmp
[0m15:50:11.349388 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m15:50:11.350371 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: drop view if exists estat_db.estat_transformed.fact_expense__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m15:50:11.452371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m15:50:11.488134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '205e76db-812f-40cf-a759-ff429631d1ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11419f790>]}
[0m15:50:11.489015 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model estat_transformed.fact_expense ......... [[32mSUCCESS 0[0m in 3.02s]
[0m15:50:11.489740 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m15:50:11.491378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:11.491786 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m15:50:11.492110 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m15:50:11.639524 [info ] [MainThread]: 
[0m15:50:11.640731 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m15:50:11.642843 [debug] [MainThread]: Command end result
[0m15:50:11.679362 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m15:50:11.681409 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m15:50:11.687112 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m15:50:11.687735 [info ] [MainThread]: 
[0m15:50:11.688414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:11.688894 [info ] [MainThread]: 
[0m15:50:11.689384 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:50:11.691971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8512096, "process_in_blocks": "0", "process_kernel_time": 0.483568, "process_mem_max_rss": "151015424", "process_out_blocks": "0", "process_user_time": 3.040716}
[0m15:50:11.692871 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:11.692684 after 5.85 seconds
[0m15:50:11.693350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d569cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cab310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118e1790>]}
[0m15:50:11.693767 [debug] [MainThread]: Flushing usage events
[0m15:50:13.333580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:52.944786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e91b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e920350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e937010>]}


============================== 20:49:52.953840 | 32b2613b-0857-44c2-a1c9-962d4dab507d ==============================
[0m20:49:52.953840 [info ] [MainThread]: Running with dbt=1.10.4
[0m20:49:52.954934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:49:53.824789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32b2613b-0857-44c2-a1c9-962d4dab507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6e8b50>]}
[0m20:49:53.901490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32b2613b-0857-44c2-a1c9-962d4dab507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5543d0>]}
[0m20:49:53.902932 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:49:54.131436 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m20:49:54.324437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:49:54.324942 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:49:54.330654 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.mart
- models.estat_dbt.vars
[0m20:49:54.370495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32b2613b-0857-44c2-a1c9-962d4dab507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a4b50>]}
[0m20:49:54.485544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m20:49:54.489279 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m20:49:54.522484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32b2613b-0857-44c2-a1c9-962d4dab507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb33090>]}
[0m20:49:54.523259 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m20:49:54.523729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32b2613b-0857-44c2-a1c9-962d4dab507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fae3e10>]}
[0m20:49:54.525617 [info ] [MainThread]: 
[0m20:49:54.526107 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:49:54.526647 [info ] [MainThread]: 
[0m20:49:54.527315 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:49:54.528338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m20:49:54.597597 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m20:49:54.598116 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m20:49:54.598427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:56.185054 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.586 seconds
[0m20:49:56.191058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m20:49:56.212585 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m20:49:56.213153 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m20:49:56.433313 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.220 seconds
[0m20:49:56.438775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32b2613b-0857-44c2-a1c9-962d4dab507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa91790>]}
[0m20:49:56.444251 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m20:49:56.445107 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m20:49:56.445700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m20:49:56.446208 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m20:49:56.462699 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m20:49:56.465066 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m20:49:56.524892 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:49:56.525855 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > t.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m20:49:57.151236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m20:49:57.168932 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:49:57.169700 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m20:49:57.613497 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.443 seconds
[0m20:49:57.621567 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:49:57.622122 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m20:49:57.709133 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.086 seconds
[0m20:49:57.725631 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:49:57.726527 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table "ESTAT_DB"."ESTAT_TRANSFORMED"."FACT_EXPENSE"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m20:49:58.007809 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.280 seconds
[0m20:49:58.058080 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m20:49:58.061627 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:49:58.062128 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m20:49:58.171226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m20:49:58.172141 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:49:58.172824 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: merge into estat_db.estat_transformed.fact_expense as DBT_INTERNAL_DEST
        using estat_db.estat_transformed.fact_expense__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.category_cd = DBT_INTERNAL_DEST.category_cd
                ) and (
                    DBT_INTERNAL_SOURCE.area_cd = DBT_INTERNAL_DEST.area_cd
                ) and (
                    DBT_INTERNAL_SOURCE.year = DBT_INTERNAL_DEST.year
                ) and (
                    DBT_INTERNAL_SOURCE.month = DBT_INTERNAL_DEST.month
                )

    
    when matched then update set
        "CATEGORY_CD" = DBT_INTERNAL_SOURCE."CATEGORY_CD","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","AREA_CD" = DBT_INTERNAL_SOURCE."AREA_CD","YEAR" = DBT_INTERNAL_SOURCE."YEAR","MONTH" = DBT_INTERNAL_SOURCE."MONTH","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")
    values
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")


/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m20:49:59.077949 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc525-0002-9d38-0002-73ea000946fe
[0m20:49:59.078629 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m20:49:59.084494 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m20:49:59.086834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32b2613b-0857-44c2-a1c9-962d4dab507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c29c50>]}
[0m20:49:59.087601 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_transformed.fact_expense ..... [[31mERROR[0m in 2.64s]
[0m20:49:59.088183 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m20:49:59.088910 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql.
[0m20:49:59.091317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:59.091922 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m20:49:59.092326 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m20:49:59.147378 [info ] [MainThread]: 
[0m20:49:59.148076 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m20:49:59.149452 [debug] [MainThread]: Command end result
[0m20:49:59.189198 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m20:49:59.192150 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m20:49:59.200354 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m20:49:59.200789 [info ] [MainThread]: 
[0m20:49:59.201209 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:59.201643 [info ] [MainThread]: 
[0m20:49:59.202063 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense/fact_expense.sql)[0m
[0m20:49:59.202490 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m20:49:59.202841 [info ] [MainThread]: 
[0m20:49:59.203237 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m20:49:59.203599 [info ] [MainThread]: 
[0m20:49:59.204204 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:49:59.205990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.352216, "process_in_blocks": "0", "process_kernel_time": 0.797998, "process_mem_max_rss": "147750912", "process_out_blocks": "0", "process_user_time": 3.158466}
[0m20:49:59.206773 [debug] [MainThread]: Command `dbt run` failed at 20:49:59.206623 after 6.35 seconds
[0m20:49:59.207708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b1dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9217d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1093d0>]}
[0m20:49:59.208238 [debug] [MainThread]: Flushing usage events
[0m20:50:00.867904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:29.601636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea66890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ead6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ead6ad0>]}


============================== 20:56:29.609407 | 77c598b6-4f4d-4db5-bba2-27286b2dce1f ==============================
[0m20:56:29.609407 [info ] [MainThread]: Running with dbt=1.10.4
[0m20:56:29.610560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:56:30.489485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77c598b6-4f4d-4db5-bba2-27286b2dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea7db10>]}
[0m20:56:30.553694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77c598b6-4f4d-4db5-bba2-27286b2dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6f42d0>]}
[0m20:56:30.555424 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:56:30.770355 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m20:56:30.968109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:56:30.969149 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense/fact_expense.sql
[0m20:56:31.333878 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.vars
- models.estat_dbt.mart
[0m20:56:31.351138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77c598b6-4f4d-4db5-bba2-27286b2dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7e3f50>]}
[0m20:56:31.424360 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m20:56:31.430682 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m20:56:31.466424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77c598b6-4f4d-4db5-bba2-27286b2dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd13e10>]}
[0m20:56:31.467122 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m20:56:31.467499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77c598b6-4f4d-4db5-bba2-27286b2dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7f5310>]}
[0m20:56:31.469564 [info ] [MainThread]: 
[0m20:56:31.470273 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:56:31.470885 [info ] [MainThread]: 
[0m20:56:31.471790 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:56:31.472912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m20:56:31.543788 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m20:56:31.544535 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m20:56:31.545049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:33.047793 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.503 seconds
[0m20:56:33.053220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m20:56:33.073962 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m20:56:33.074567 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m20:56:33.520839 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.446 seconds
[0m20:56:33.526874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77c598b6-4f4d-4db5-bba2-27286b2dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8a6690>]}
[0m20:56:33.536914 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m20:56:33.538485 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m20:56:33.539808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m20:56:33.540925 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m20:56:33.560216 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m20:56:33.565938 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m20:56:33.628654 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:56:33.629204 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg s
    WHERE loaded_time = (
        SELECT max(loaded_time) from s
    )
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > t.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m20:56:33.884139 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc52c-0002-9d38-0002-73ea0009470a
[0m20:56:33.885377 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ESTAT_DB.ESTAT_TRANSFORMED.S' does not exist or not authorized.
[0m20:56:33.894742 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002003 (42S02): SQL compilation error:
  Object 'ESTAT_DB.ESTAT_TRANSFORMED.S' does not exist or not authorized.
[0m20:56:33.898520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c598b6-4f4d-4db5-bba2-27286b2dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd4e810>]}
[0m20:56:33.899863 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_transformed.fact_expense ..... [[31mERROR[0m in 0.36s]
[0m20:56:33.900911 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m20:56:33.901881 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002003 (42S02): SQL compilation error:
  Object 'ESTAT_DB.ESTAT_TRANSFORMED.S' does not exist or not authorized..
[0m20:56:33.905222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:33.905830 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m20:56:33.906347 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m20:56:33.975365 [info ] [MainThread]: 
[0m20:56:33.976529 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m20:56:33.978387 [debug] [MainThread]: Command end result
[0m20:56:34.011305 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m20:56:34.013607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m20:56:34.019848 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m20:56:34.020283 [info ] [MainThread]: 
[0m20:56:34.020785 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:56:34.021190 [info ] [MainThread]: 
[0m20:56:34.021763 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense/fact_expense.sql)[0m
[0m20:56:34.022549 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002003 (42S02): SQL compilation error:
  Object 'ESTAT_DB.ESTAT_TRANSFORMED.S' does not exist or not authorized.
[0m20:56:34.022972 [info ] [MainThread]: 
[0m20:56:34.023425 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m20:56:34.023870 [info ] [MainThread]: 
[0m20:56:34.024286 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:56:34.025940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.5189075, "process_in_blocks": "0", "process_kernel_time": 0.781184, "process_mem_max_rss": "151523328", "process_out_blocks": "0", "process_user_time": 3.238067}
[0m20:56:34.026680 [debug] [MainThread]: Command `dbt run` failed at 20:56:34.026533 after 4.52 seconds
[0m20:56:34.027169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a355d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ad550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c09f6d0>]}
[0m20:56:34.027605 [debug] [MainThread]: Flushing usage events
[0m20:56:35.508500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:33.905198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052219d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105237250>]}


============================== 20:57:33.913476 | 1baea221-7ff6-4b72-9391-907c1dec607a ==============================
[0m20:57:33.913476 [info ] [MainThread]: Running with dbt=1.10.4
[0m20:57:33.914544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'profiles_dir': '/Users/tthuha236/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:57:34.766621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1baea221-7ff6-4b72-9391-907c1dec607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050db510>]}
[0m20:57:34.833931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1baea221-7ff6-4b72-9391-907c1dec607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e54190>]}
[0m20:57:34.835301 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:57:35.046061 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m20:57:35.239476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:35.240305 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense/fact_expense.sql
[0m20:57:35.572056 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.mart
- models.estat_dbt.vars
[0m20:57:35.588550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1baea221-7ff6-4b72-9391-907c1dec607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c1750>]}
[0m20:57:35.661479 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m20:57:35.668510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m20:57:35.705595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1baea221-7ff6-4b72-9391-907c1dec607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fd850>]}
[0m20:57:35.706234 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m20:57:35.706575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1baea221-7ff6-4b72-9391-907c1dec607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106532a50>]}
[0m20:57:35.708427 [info ] [MainThread]: 
[0m20:57:35.708987 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:57:35.709387 [info ] [MainThread]: 
[0m20:57:35.710323 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:57:35.711632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m20:57:35.784140 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m20:57:35.784605 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m20:57:35.784918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:37.571619 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.786 seconds
[0m20:57:37.577626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m20:57:37.599317 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m20:57:37.599920 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m20:57:37.814994 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.214 seconds
[0m20:57:37.820449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1baea221-7ff6-4b72-9391-907c1dec607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106417d50>]}
[0m20:57:37.829777 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m20:57:37.831036 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m20:57:37.832105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m20:57:37.832977 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m20:57:37.850425 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m20:57:37.853538 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m20:57:37.912874 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:57:37.913422 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg source
    WHERE loaded_time = (
        SELECT max(loaded_time) from source
    )
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > t.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m20:57:38.045021 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc52d-0002-9dff-0002-73ea000aa2c2
[0m20:57:38.045866 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ESTAT_DB.ESTAT_TRANSFORMED.SOURCE' does not exist or not authorized.
[0m20:57:38.053210 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002003 (42S02): SQL compilation error:
  Object 'ESTAT_DB.ESTAT_TRANSFORMED.SOURCE' does not exist or not authorized.
[0m20:57:38.056147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1baea221-7ff6-4b72-9391-907c1dec607a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771d590>]}
[0m20:57:38.057234 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_transformed.fact_expense ..... [[31mERROR[0m in 0.22s]
[0m20:57:38.058191 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m20:57:38.059424 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002003 (42S02): SQL compilation error:
  Object 'ESTAT_DB.ESTAT_TRANSFORMED.SOURCE' does not exist or not authorized..
[0m20:57:38.062196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:38.062754 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m20:57:38.063217 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m20:57:38.343036 [info ] [MainThread]: 
[0m20:57:38.344933 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m20:57:38.347401 [debug] [MainThread]: Command end result
[0m20:57:38.382731 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m20:57:38.385025 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m20:57:38.390716 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m20:57:38.391141 [info ] [MainThread]: 
[0m20:57:38.391568 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:57:38.392182 [info ] [MainThread]: 
[0m20:57:38.393043 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense/fact_expense.sql)[0m
[0m20:57:38.393637 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002003 (42S02): SQL compilation error:
  Object 'ESTAT_DB.ESTAT_TRANSFORMED.SOURCE' does not exist or not authorized.
[0m20:57:38.394077 [info ] [MainThread]: 
[0m20:57:38.394580 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m20:57:38.394891 [info ] [MainThread]: 
[0m20:57:38.395286 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:57:38.396959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.5765734, "process_in_blocks": "0", "process_kernel_time": 0.811258, "process_mem_max_rss": "151203840", "process_out_blocks": "0", "process_user_time": 3.284508}
[0m20:57:38.397644 [debug] [MainThread]: Command `dbt run` failed at 20:57:38.397527 after 4.58 seconds
[0m20:57:38.398084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ab5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105220690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a0e950>]}
[0m20:57:38.398458 [debug] [MainThread]: Flushing usage events
[0m20:57:39.140471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:14.057535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d0690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091423d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091427d0>]}


============================== 20:59:14.067038 | f6d365f6-72da-4fb9-a5f5-b51fef01e009 ==============================
[0m20:59:14.067038 [info ] [MainThread]: Running with dbt=1.10.4
[0m20:59:14.067967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:59:14.918755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6d365f6-72da-4fb9-a5f5-b51fef01e009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab0790>]}
[0m20:59:14.983317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6d365f6-72da-4fb9-a5f5-b51fef01e009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b3e50>]}
[0m20:59:14.985274 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:59:15.196999 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m20:59:15.389324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:59:15.390058 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense/fact_expense.sql
[0m20:59:15.720362 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.mart
- models.estat_dbt.vars
[0m20:59:15.736796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d365f6-72da-4fb9-a5f5-b51fef01e009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a475550>]}
[0m20:59:15.811564 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m20:59:15.817132 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m20:59:15.853752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d365f6-72da-4fb9-a5f5-b51fef01e009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b10cf50>]}
[0m20:59:15.854311 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m20:59:15.854749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d365f6-72da-4fb9-a5f5-b51fef01e009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3356d0>]}
[0m20:59:15.856600 [info ] [MainThread]: 
[0m20:59:15.857378 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:59:15.858054 [info ] [MainThread]: 
[0m20:59:15.858944 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:59:15.860288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m20:59:15.932605 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m20:59:15.933056 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m20:59:15.933375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:17.565085 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.632 seconds
[0m20:59:17.570860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m20:59:17.591569 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m20:59:17.592192 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m20:59:17.710391 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m20:59:17.715625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d365f6-72da-4fb9-a5f5-b51fef01e009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41d850>]}
[0m20:59:17.722239 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m20:59:17.723364 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m20:59:17.724601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m20:59:17.725398 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m20:59:17.743960 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m20:59:17.746211 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m20:59:17.807948 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:59:17.808827 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg stg
    WHERE loaded_time = (
        SELECT max(loaded_time) from stg
    )
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > t.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m20:59:18.048773 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc52f-0002-9cc8-0002-73ea0009af22
[0m20:59:18.049792 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ESTAT_DB.ESTAT_TRANSFORMED.STG' does not exist or not authorized.
[0m20:59:18.057114 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002003 (42S02): SQL compilation error:
  Object 'ESTAT_DB.ESTAT_TRANSFORMED.STG' does not exist or not authorized.
[0m20:59:18.060438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d365f6-72da-4fb9-a5f5-b51fef01e009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e6bd0>]}
[0m20:59:18.061717 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_transformed.fact_expense ..... [[31mERROR[0m in 0.33s]
[0m20:59:18.062646 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m20:59:18.063501 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002003 (42S02): SQL compilation error:
  Object 'ESTAT_DB.ESTAT_TRANSFORMED.STG' does not exist or not authorized..
[0m20:59:18.066295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:18.066982 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m20:59:18.067572 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m20:59:18.159126 [info ] [MainThread]: 
[0m20:59:18.160897 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m20:59:18.163775 [debug] [MainThread]: Command end result
[0m20:59:18.198503 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m20:59:18.201562 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m20:59:18.208533 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m20:59:18.209034 [info ] [MainThread]: 
[0m20:59:18.209527 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:59:18.209946 [info ] [MainThread]: 
[0m20:59:18.210569 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense/fact_expense.sql)[0m
[0m20:59:18.211100 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  002003 (42S02): SQL compilation error:
  Object 'ESTAT_DB.ESTAT_TRANSFORMED.STG' does not exist or not authorized.
[0m20:59:18.211494 [info ] [MainThread]: 
[0m20:59:18.211901 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m20:59:18.212294 [info ] [MainThread]: 
[0m20:59:18.212697 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:59:18.214506 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.2545056, "process_in_blocks": "0", "process_kernel_time": 0.757512, "process_mem_max_rss": "150749184", "process_out_blocks": "0", "process_user_time": 3.163708}
[0m20:59:18.215123 [debug] [MainThread]: Command `dbt run` failed at 20:59:18.214999 after 4.26 seconds
[0m20:59:18.215639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049bddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104916b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104915610>]}
[0m20:59:18.216077 [debug] [MainThread]: Flushing usage events
[0m20:59:20.051846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:36.943344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf0810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c62c90>]}


============================== 20:59:36.952196 | 03bd038d-4aa4-42c5-9cd8-31b1b0ddfaab ==============================
[0m20:59:36.952196 [info ] [MainThread]: Running with dbt=1.10.4
[0m20:59:36.953302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tthuha236/.dbt', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:59:37.670604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03bd038d-4aa4-42c5-9cd8-31b1b0ddfaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c9ad0>]}
[0m20:59:37.757679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03bd038d-4aa4-42c5-9cd8-31b1b0ddfaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088800d0>]}
[0m20:59:37.759352 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m20:59:38.058707 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m20:59:38.234317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:59:38.235065 [debug] [MainThread]: Partial parsing: updated file: estat_dbt://models/transformed/fact_expense/fact_expense.sql
[0m20:59:38.652568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.mart
- models.estat_dbt.vars
[0m20:59:38.669821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03bd038d-4aa4-42c5-9cd8-31b1b0ddfaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb0a10>]}
[0m20:59:38.744061 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m20:59:38.747869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m20:59:38.790562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03bd038d-4aa4-42c5-9cd8-31b1b0ddfaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6c210>]}
[0m20:59:38.791680 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m20:59:38.792252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03bd038d-4aa4-42c5-9cd8-31b1b0ddfaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f15090>]}
[0m20:59:38.794791 [info ] [MainThread]: 
[0m20:59:38.795436 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:59:38.796149 [info ] [MainThread]: 
[0m20:59:38.796900 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:59:38.798164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m20:59:38.866070 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m20:59:38.866531 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m20:59:38.866840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:39.707505 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.841 seconds
[0m20:59:39.711422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m20:59:39.729668 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m20:59:39.730193 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m20:59:39.976160 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.245 seconds
[0m20:59:39.982054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03bd038d-4aa4-42c5-9cd8-31b1b0ddfaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb8cd0>]}
[0m20:59:39.990363 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m20:59:39.991893 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m20:59:39.993536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m20:59:39.994613 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m20:59:40.016351 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m20:59:40.018413 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m20:59:40.087061 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:59:40.087891 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg 
    WHERE loaded_time = (
        SELECT max(loaded_time) from estat_db.estat_stg.fact_expense_stg 
    )
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > t.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m20:59:40.390385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m20:59:40.403312 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:59:40.403807 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m20:59:40.579864 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.175 seconds
[0m20:59:40.586548 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:59:40.587289 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m20:59:40.651291 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.063 seconds
[0m20:59:40.668022 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:59:40.668910 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table "ESTAT_DB"."ESTAT_TRANSFORMED"."FACT_EXPENSE"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m20:59:40.728890 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.059 seconds
[0m20:59:40.776252 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m20:59:40.778959 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:59:40.779466 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m20:59:41.022485 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m20:59:41.023278 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m20:59:41.023925 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: merge into estat_db.estat_transformed.fact_expense as DBT_INTERNAL_DEST
        using estat_db.estat_transformed.fact_expense__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.category_cd = DBT_INTERNAL_DEST.category_cd
                ) and (
                    DBT_INTERNAL_SOURCE.area_cd = DBT_INTERNAL_DEST.area_cd
                ) and (
                    DBT_INTERNAL_SOURCE.year = DBT_INTERNAL_DEST.year
                ) and (
                    DBT_INTERNAL_SOURCE.month = DBT_INTERNAL_DEST.month
                )

    
    when matched then update set
        "CATEGORY_CD" = DBT_INTERNAL_SOURCE."CATEGORY_CD","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","AREA_CD" = DBT_INTERNAL_SOURCE."AREA_CD","YEAR" = DBT_INTERNAL_SOURCE."YEAR","MONTH" = DBT_INTERNAL_SOURCE."MONTH","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")
    values
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")


/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m20:59:41.600446 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc52f-0002-9d43-0002-73ea000a465a
[0m20:59:41.601950 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m20:59:41.611562 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m20:59:41.615623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03bd038d-4aa4-42c5-9cd8-31b1b0ddfaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f86210>]}
[0m20:59:41.616979 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_transformed.fact_expense ..... [[31mERROR[0m in 1.62s]
[0m20:59:41.618258 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m20:59:41.619503 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql.
[0m20:59:41.622935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:41.623888 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m20:59:41.624933 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m20:59:41.690176 [info ] [MainThread]: 
[0m20:59:41.690697 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m20:59:41.691654 [debug] [MainThread]: Command end result
[0m20:59:41.721475 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m20:59:41.724543 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m20:59:41.733445 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m20:59:41.733892 [info ] [MainThread]: 
[0m20:59:41.734327 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:59:41.734777 [info ] [MainThread]: 
[0m20:59:41.735427 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense/fact_expense.sql)[0m
[0m20:59:41.736151 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m20:59:41.736586 [info ] [MainThread]: 
[0m20:59:41.736982 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m20:59:41.737286 [info ] [MainThread]: 
[0m20:59:41.737638 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:59:41.739254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.874657, "process_in_blocks": "0", "process_kernel_time": 0.739978, "process_mem_max_rss": "152154112", "process_out_blocks": "0", "process_user_time": 3.325078}
[0m20:59:41.739861 [debug] [MainThread]: Command `dbt run` failed at 20:59:41.739746 after 4.88 seconds
[0m20:59:41.740341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034e1d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf0090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10343a950>]}
[0m20:59:41.740924 [debug] [MainThread]: Flushing usage events
[0m20:59:43.306705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:05:25.629607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093058d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931afd0>]}


============================== 21:05:25.638856 | 0c0924c8-97ad-4eec-ad5d-1f4f25719fc8 ==============================
[0m21:05:25.638856 [info ] [MainThread]: Running with dbt=1.10.4
[0m21:05:25.639689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:05:26.445048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c0924c8-97ad-4eec-ad5d-1f4f25719fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc3610>]}
[0m21:05:26.511096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c0924c8-97ad-4eec-ad5d-1f4f25719fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e73f50>]}
[0m21:05:26.512341 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m21:05:26.731571 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m21:05:26.907321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:26.907796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:26.913791 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.mart
- models.estat_dbt.vars
[0m21:05:26.949313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c0924c8-97ad-4eec-ad5d-1f4f25719fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a238090>]}
[0m21:05:27.024440 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m21:05:27.031312 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m21:05:27.073940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c0924c8-97ad-4eec-ad5d-1f4f25719fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d1290>]}
[0m21:05:27.074847 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m21:05:27.075356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c0924c8-97ad-4eec-ad5d-1f4f25719fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8f990>]}
[0m21:05:27.077236 [info ] [MainThread]: 
[0m21:05:27.077821 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m21:05:27.078263 [info ] [MainThread]: 
[0m21:05:27.079014 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:05:27.080299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m21:05:27.156035 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m21:05:27.156515 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m21:05:27.156828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:28.629244 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.472 seconds
[0m21:05:28.632665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m21:05:28.652529 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m21:05:28.653062 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m21:05:29.020830 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.366 seconds
[0m21:05:29.024652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c0924c8-97ad-4eec-ad5d-1f4f25719fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a237f50>]}
[0m21:05:29.030032 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m21:05:29.030868 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m21:05:29.031696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m21:05:29.032901 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m21:05:29.049451 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m21:05:29.052406 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m21:05:29.128471 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:05:29.129249 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg 
    WHERE loaded_time = (
        SELECT max(loaded_time) from estat_db.estat_stg.fact_expense_stg 
    )
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > t.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m21:05:29.519001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m21:05:29.536871 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:05:29.537652 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m21:05:29.678011 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.140 seconds
[0m21:05:29.687222 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:05:29.688212 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m21:05:29.745250 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.056 seconds
[0m21:05:29.762026 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:05:29.763155 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table "ESTAT_DB"."ESTAT_TRANSFORMED"."FACT_EXPENSE"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m21:05:29.840445 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.076 seconds
[0m21:05:29.889207 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m21:05:29.891630 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:05:29.892058 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m21:05:30.067267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m21:05:30.068629 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:05:30.069700 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: merge into estat_db.estat_transformed.fact_expense as DBT_INTERNAL_DEST
        using estat_db.estat_transformed.fact_expense__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.category_cd = DBT_INTERNAL_DEST.category_cd
                ) and (
                    DBT_INTERNAL_SOURCE.area_cd = DBT_INTERNAL_DEST.area_cd
                ) and (
                    DBT_INTERNAL_SOURCE.year = DBT_INTERNAL_DEST.year
                ) and (
                    DBT_INTERNAL_SOURCE.month = DBT_INTERNAL_DEST.month
                )

    
    when matched then update set
        "CATEGORY_CD" = DBT_INTERNAL_SOURCE."CATEGORY_CD","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","AREA_CD" = DBT_INTERNAL_SOURCE."AREA_CD","YEAR" = DBT_INTERNAL_SOURCE."YEAR","MONTH" = DBT_INTERNAL_SOURCE."MONTH","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")
    values
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")


/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m21:05:30.584084 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bdc535-0002-9e28-0002-73ea000af25a
[0m21:05:30.585096 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m21:05:30.592103 [debug] [Thread-1 (]: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m21:05:30.595175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c0924c8-97ad-4eec-ad5d-1f4f25719fc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b507fd0>]}
[0m21:05:30.596242 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model estat_transformed.fact_expense ..... [[31mERROR[0m in 1.56s]
[0m21:05:30.597537 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m21:05:30.598533 [debug] [Thread-6 (]: Marking all children of 'model.estat_dbt.fact_expense' to be skipped because of status 'error'.  Reason: Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql.
[0m21:05:30.601460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:30.601948 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m21:05:30.602338 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m21:05:30.801110 [info ] [MainThread]: 
[0m21:05:30.802073 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m21:05:30.803678 [debug] [MainThread]: Command end result
[0m21:05:30.833933 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m21:05:30.836123 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m21:05:30.844792 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m21:05:30.845257 [info ] [MainThread]: 
[0m21:05:30.845698 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:05:30.846086 [info ] [MainThread]: 
[0m21:05:30.846593 [error] [MainThread]: [31mFailure in model fact_expense (models/transformed/fact_expense/fact_expense.sql)[0m
[0m21:05:30.847123 [error] [MainThread]:   Database Error in model fact_expense (models/transformed/fact_expense/fact_expense.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m21:05:30.847538 [info ] [MainThread]: 
[0m21:05:30.848063 [info ] [MainThread]:   compiled code at target/compiled/estat_dbt/models/transformed/fact_expense/fact_expense.sql
[0m21:05:30.848495 [info ] [MainThread]: 
[0m21:05:30.848939 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:05:30.850827 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.3144383, "process_in_blocks": "0", "process_kernel_time": 0.765862, "process_mem_max_rss": "147849216", "process_out_blocks": "0", "process_user_time": 3.075459}
[0m21:05:30.851702 [debug] [MainThread]: Command `dbt run` failed at 21:05:30.851455 after 5.32 seconds
[0m21:05:30.852532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109057210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b52910>]}
[0m21:05:30.853567 [debug] [MainThread]: Flushing usage events
[0m21:05:32.910626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:23:48.651607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcccb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd3e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd3ebd0>]}


============================== 21:23:48.660200 | 30b58c99-ec5e-493c-b288-bea0f53bcf34 ==============================
[0m21:23:48.660200 [info ] [MainThread]: Running with dbt=1.10.4
[0m21:23:48.661276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'profiles_dir': '/Users/tthuha236/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:23:49.418550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30b58c99-ec5e-493c-b288-bea0f53bcf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caaa510>]}
[0m21:23:49.491199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30b58c99-ec5e-493c-b288-bea0f53bcf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c95c190>]}
[0m21:23:49.493121 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m21:23:49.706538 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m21:23:49.881401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:23:49.881876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:23:49.887509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.mart
- models.estat_dbt.vars
[0m21:23:49.921111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30b58c99-ec5e-493c-b288-bea0f53bcf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8eb90>]}
[0m21:23:49.998366 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m21:23:50.004356 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m21:23:50.042043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30b58c99-ec5e-493c-b288-bea0f53bcf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf3d790>]}
[0m21:23:50.042880 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m21:23:50.043401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b58c99-ec5e-493c-b288-bea0f53bcf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8d610>]}
[0m21:23:50.045483 [info ] [MainThread]: 
[0m21:23:50.046034 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m21:23:50.046479 [info ] [MainThread]: 
[0m21:23:50.047423 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:50.048737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m21:23:50.129014 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m21:23:50.129463 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m21:23:50.129770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:51.816494 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.687 seconds
[0m21:23:51.822532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m21:23:51.842975 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m21:23:51.843577 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m21:23:51.954531 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m21:23:51.961832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b58c99-ec5e-493c-b288-bea0f53bcf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9daed0>]}
[0m21:23:51.966741 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m21:23:51.967696 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m21:23:51.968383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m21:23:51.968891 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m21:23:51.986602 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m21:23:51.990561 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m21:23:52.047705 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:23:52.048260 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg 
    WHERE loaded_time = (
        SELECT max(loaded_time) from estat_db.estat_stg.fact_expense_stg 
    )
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > t.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m21:23:52.357421 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.308 seconds
[0m21:23:52.375330 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:23:52.376113 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m21:23:52.438906 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.062 seconds
[0m21:23:52.447489 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:23:52.448388 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m21:23:52.566877 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.118 seconds
[0m21:23:52.583256 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:23:52.584089 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table "ESTAT_DB"."ESTAT_TRANSFORMED"."FACT_EXPENSE"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m21:23:52.664677 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.080 seconds
[0m21:23:52.712357 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m21:23:52.716371 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:23:52.717030 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m21:23:52.884843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m21:23:52.886231 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:23:52.887951 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: merge into estat_db.estat_transformed.fact_expense as DBT_INTERNAL_DEST
        using estat_db.estat_transformed.fact_expense__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.category_cd = DBT_INTERNAL_DEST.category_cd
                ) and (
                    DBT_INTERNAL_SOURCE.area_cd = DBT_INTERNAL_DEST.area_cd
                ) and (
                    DBT_INTERNAL_SOURCE.year = DBT_INTERNAL_DEST.year
                ) and (
                    DBT_INTERNAL_SOURCE.month = DBT_INTERNAL_DEST.month
                )

    
    when matched then update set
        "CATEGORY_CD" = DBT_INTERNAL_SOURCE."CATEGORY_CD","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","AREA_CD" = DBT_INTERNAL_SOURCE."AREA_CD","YEAR" = DBT_INTERNAL_SOURCE."YEAR","MONTH" = DBT_INTERNAL_SOURCE."MONTH","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")
    values
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")


/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m21:23:53.446392 [debug] [Thread-1 (]: SQL status: SUCCESS 3172 in 0.557 seconds
[0m21:23:53.447191 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:23:53.447740 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m21:23:53.646564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m21:23:53.664712 [debug] [Thread-1 (]: Applying DROP to: estat_db.estat_transformed.fact_expense__dbt_tmp
[0m21:23:53.676780 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m21:23:53.677418 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: drop view if exists estat_db.estat_transformed.fact_expense__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m21:23:53.817367 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m21:23:53.852797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b58c99-ec5e-493c-b288-bea0f53bcf34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0fcad0>]}
[0m21:23:53.853647 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model estat_transformed.fact_expense ......... [[32mSUCCESS 3172[0m in 1.88s]
[0m21:23:53.854334 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m21:23:53.856237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:53.856709 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m21:23:53.857015 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m21:23:53.938681 [info ] [MainThread]: 
[0m21:23:53.939865 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m21:23:53.941815 [debug] [MainThread]: Command end result
[0m21:23:53.974214 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m21:23:53.976389 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m21:23:53.983708 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m21:23:53.984355 [info ] [MainThread]: 
[0m21:23:53.985106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:53.986000 [info ] [MainThread]: 
[0m21:23:53.986805 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:23:53.989002 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4224296, "process_in_blocks": "0", "process_kernel_time": 0.741452, "process_mem_max_rss": "146370560", "process_out_blocks": "0", "process_user_time": 2.969895}
[0m21:23:53.989990 [debug] [MainThread]: Command `dbt run` succeeded at 21:23:53.989789 after 5.42 seconds
[0m21:23:53.990479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075bdd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745df10>]}
[0m21:23:53.990874 [debug] [MainThread]: Flushing usage events
[0m21:23:55.384350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:53.051143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105286f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ddd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053dee10>]}


============================== 22:08:53.060218 | 15c667af-f95a-4e85-ba10-079e539b6461 ==============================
[0m22:08:53.060218 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:08:53.061102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:08:53.870820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15c667af-f95a-4e85-ba10-079e539b6461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510f610>]}
[0m22:08:53.935194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15c667af-f95a-4e85-ba10-079e539b6461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f74390>]}
[0m22:08:53.937050 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:08:54.151258 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m22:08:54.348900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:08:54.349376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:08:54.355035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.vars
- models.estat_dbt.mart
[0m22:08:54.390842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15c667af-f95a-4e85-ba10-079e539b6461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064780d0>]}
[0m22:08:54.467542 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m22:08:54.472203 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m22:08:54.506368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15c667af-f95a-4e85-ba10-079e539b6461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c9710>]}
[0m22:08:54.506920 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m22:08:54.507339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c667af-f95a-4e85-ba10-079e539b6461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656d950>]}
[0m22:08:54.509413 [info ] [MainThread]: 
[0m22:08:54.509953 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m22:08:54.510354 [info ] [MainThread]: 
[0m22:08:54.511121 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:08:54.512355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m22:08:54.596840 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m22:08:54.597314 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m22:08:54.597645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:56.657311 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.059 seconds
[0m22:08:56.663465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m22:08:56.685028 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m22:08:56.685637 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m22:08:56.769603 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.083 seconds
[0m22:08:56.777644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c667af-f95a-4e85-ba10-079e539b6461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656c310>]}
[0m22:08:56.787575 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m22:08:56.788803 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m22:08:56.789815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m22:08:56.790700 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m22:08:56.813096 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m22:08:56.815704 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m22:08:56.872197 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:08:56.872796 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg 
    WHERE loaded_time = (
        SELECT max(loaded_time) from estat_db.estat_stg.fact_expense_stg 
    )
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > t.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m22:08:57.160781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m22:08:57.179098 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:08:57.179834 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m22:08:57.288840 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.108 seconds
[0m22:08:57.297603 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:08:57.298505 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m22:08:57.442694 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.143 seconds
[0m22:08:57.458775 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:08:57.459594 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table "ESTAT_DB"."ESTAT_TRANSFORMED"."FACT_EXPENSE"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m22:08:57.584000 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.124 seconds
[0m22:08:57.623460 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m22:08:57.626346 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:08:57.626836 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m22:08:57.741201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m22:08:57.742549 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:08:57.743707 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: merge into estat_db.estat_transformed.fact_expense as DBT_INTERNAL_DEST
        using estat_db.estat_transformed.fact_expense__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.category_cd = DBT_INTERNAL_DEST.category_cd
                ) and (
                    DBT_INTERNAL_SOURCE.area_cd = DBT_INTERNAL_DEST.area_cd
                ) and (
                    DBT_INTERNAL_SOURCE.year = DBT_INTERNAL_DEST.year
                ) and (
                    DBT_INTERNAL_SOURCE.month = DBT_INTERNAL_DEST.month
                )

    
    when matched then update set
        "CATEGORY_CD" = DBT_INTERNAL_SOURCE."CATEGORY_CD","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","AREA_CD" = DBT_INTERNAL_SOURCE."AREA_CD","YEAR" = DBT_INTERNAL_SOURCE."YEAR","MONTH" = DBT_INTERNAL_SOURCE."MONTH","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")
    values
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")


/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m22:08:58.381154 [debug] [Thread-1 (]: SQL status: SUCCESS 3172 in 0.636 seconds
[0m22:08:58.383018 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:08:58.384160 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m22:08:58.701538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m22:08:58.718959 [debug] [Thread-1 (]: Applying DROP to: estat_db.estat_transformed.fact_expense__dbt_tmp
[0m22:08:58.729889 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:08:58.730522 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: drop view if exists estat_db.estat_transformed.fact_expense__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m22:08:58.847896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m22:08:58.888197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c667af-f95a-4e85-ba10-079e539b6461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752cf50>]}
[0m22:08:58.889115 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model estat_transformed.fact_expense ......... [[32mSUCCESS 3172[0m in 2.10s]
[0m22:08:58.889790 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m22:08:58.891445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:58.891860 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m22:08:58.892199 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m22:08:59.026219 [info ] [MainThread]: 
[0m22:08:59.028498 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m22:08:59.030762 [debug] [MainThread]: Command end result
[0m22:08:59.065112 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m22:08:59.067234 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m22:08:59.073222 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m22:08:59.073676 [info ] [MainThread]: 
[0m22:08:59.074339 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:59.074742 [info ] [MainThread]: 
[0m22:08:59.075316 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:08:59.077314 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1089973, "process_in_blocks": "0", "process_kernel_time": 0.759955, "process_mem_max_rss": "146894848", "process_out_blocks": "0", "process_user_time": 3.04016}
[0m22:08:59.078032 [debug] [MainThread]: Command `dbt run` succeeded at 22:08:59.077876 after 6.11 seconds
[0m22:08:59.078547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ca5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105026550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b49e50>]}
[0m22:08:59.079096 [debug] [MainThread]: Flushing usage events
[0m22:09:01.117346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:11:16.343544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db5ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbce510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbce990>]}


============================== 22:11:16.351412 | 770eef11-db4b-4241-a2dc-1bce07e99764 ==============================
[0m22:11:16.351412 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:11:16.352325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tthuha236/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:17.101708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '770eef11-db4b-4241-a2dc-1bce07e99764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbb66d0>]}
[0m22:11:17.165547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '770eef11-db4b-4241-a2dc-1bce07e99764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e738110>]}
[0m22:11:17.167077 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:11:17.377547 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m22:11:17.542830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:11:17.543334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:11:17.548842 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.estat_dbt.vars
- models.estat_dbt.mart
[0m22:11:17.582583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '770eef11-db4b-4241-a2dc-1bce07e99764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaebed0>]}
[0m22:11:17.654262 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m22:11:17.658095 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m22:11:17.691888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '770eef11-db4b-4241-a2dc-1bce07e99764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed83390>]}
[0m22:11:17.692427 [info ] [MainThread]: Found 1 model, 1 source, 478 macros
[0m22:11:17.692769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '770eef11-db4b-4241-a2dc-1bce07e99764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b743950>]}
[0m22:11:17.694660 [info ] [MainThread]: 
[0m22:11:17.695180 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m22:11:17.695613 [info ] [MainThread]: 
[0m22:11:17.696387 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:11:17.697551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_estat_db'
[0m22:11:17.766966 [debug] [ThreadPool]: Using snowflake connection "list_estat_db"
[0m22:11:17.767508 [debug] [ThreadPool]: On list_estat_db: show terse schemas in database estat_db
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db"} */
[0m22:11:17.767821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:19.140158 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.372 seconds
[0m22:11:19.142664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_estat_db, now list_estat_db_estat_transformed)
[0m22:11:19.155229 [debug] [ThreadPool]: Using snowflake connection "list_estat_db_estat_transformed"
[0m22:11:19.155664 [debug] [ThreadPool]: On list_estat_db_estat_transformed: show objects in estat_db.estat_transformed
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "connection_name": "list_estat_db_estat_transformed"} */;
[0m22:11:19.254821 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m22:11:19.259427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '770eef11-db4b-4241-a2dc-1bce07e99764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fce9f10>]}
[0m22:11:19.264419 [debug] [Thread-1 (]: Began running node model.estat_dbt.fact_expense
[0m22:11:19.265037 [info ] [Thread-1 (]: 1 of 1 START sql incremental model estat_transformed.fact_expense .............. [RUN]
[0m22:11:19.265637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_estat_db_estat_transformed, now model.estat_dbt.fact_expense)
[0m22:11:19.266092 [debug] [Thread-1 (]: Began compiling node model.estat_dbt.fact_expense
[0m22:11:19.280945 [debug] [Thread-1 (]: Writing injected SQL for node "model.estat_dbt.fact_expense"
[0m22:11:19.282630 [debug] [Thread-1 (]: Began executing node model.estat_dbt.fact_expense
[0m22:11:19.341510 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:11:19.342128 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: create or replace  temporary view estat_db.estat_transformed.fact_expense__dbt_tmp
  
  
  
  
  as (
    WITH stg_table AS (
    SELECT * FROM estat_db.estat_stg.fact_expense_stg 
    WHERE loaded_time = (
        SELECT max(loaded_time) from estat_db.estat_stg.fact_expense_stg 
    )
)
SELECT 
    s.category_cd,
    s.amount, 
    s.area_cd, 
    s.year,
    s.month,
    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,
    CURRENT_TIMESTAMP() as updated_at
FROM stg_table s
LEFT JOIN estat_db.estat_transformed.fact_expense t
ON s.category_cd = t.category_cd
  AND s.area_cd = t.area_cd
  AND s.year = t.year
  AND s.month = t.month


WHERE t.category_cd is null or s.loaded_time > t.updated_at

  )
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m22:11:19.664489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.322 seconds
[0m22:11:19.678662 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:11:19.679374 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m22:11:19.766049 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.086 seconds
[0m22:11:19.774944 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:11:19.775881 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table estat_db.estat_transformed.fact_expense
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m22:11:19.836781 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.060 seconds
[0m22:11:19.853416 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:11:19.854949 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: describe table "ESTAT_DB"."ESTAT_TRANSFORMED"."FACT_EXPENSE"
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m22:11:19.961028 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.105 seconds
[0m22:11:20.009348 [debug] [Thread-1 (]: Writing runtime sql for node "model.estat_dbt.fact_expense"
[0m22:11:20.011198 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:11:20.011576 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m22:11:20.184574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m22:11:20.186112 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:11:20.187264 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: merge into estat_db.estat_transformed.fact_expense as DBT_INTERNAL_DEST
        using estat_db.estat_transformed.fact_expense__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.category_cd = DBT_INTERNAL_DEST.category_cd
                ) and (
                    DBT_INTERNAL_SOURCE.area_cd = DBT_INTERNAL_DEST.area_cd
                ) and (
                    DBT_INTERNAL_SOURCE.year = DBT_INTERNAL_DEST.year
                ) and (
                    DBT_INTERNAL_SOURCE.month = DBT_INTERNAL_DEST.month
                )

    
    when matched then update set
        "CATEGORY_CD" = DBT_INTERNAL_SOURCE."CATEGORY_CD","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","AREA_CD" = DBT_INTERNAL_SOURCE."AREA_CD","YEAR" = DBT_INTERNAL_SOURCE."YEAR","MONTH" = DBT_INTERNAL_SOURCE."MONTH","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT"
    

    when not matched then insert
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")
    values
        ("CATEGORY_CD", "AMOUNT", "AREA_CD", "YEAR", "MONTH", "CREATED_AT", "UPDATED_AT")


/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */;
[0m22:11:21.433898 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 1.245 seconds
[0m22:11:21.435751 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:11:21.437152 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m22:11:21.851977 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m22:11:21.874236 [debug] [Thread-1 (]: Applying DROP to: estat_db.estat_transformed.fact_expense__dbt_tmp
[0m22:11:21.895119 [debug] [Thread-1 (]: Using snowflake connection "model.estat_dbt.fact_expense"
[0m22:11:21.908714 [debug] [Thread-1 (]: On model.estat_dbt.fact_expense: drop view if exists estat_db.estat_transformed.fact_expense__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "estat_dbt", "target_name": "dev", "node_id": "model.estat_dbt.fact_expense"} */
[0m22:11:22.062560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m22:11:22.086291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '770eef11-db4b-4241-a2dc-1bce07e99764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff27350>]}
[0m22:11:22.087128 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model estat_transformed.fact_expense ......... [[32mSUCCESS 3[0m in 2.82s]
[0m22:11:22.087871 [debug] [Thread-1 (]: Finished running node model.estat_dbt.fact_expense
[0m22:11:22.089772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:22.090165 [debug] [MainThread]: Connection 'model.estat_dbt.fact_expense' was left open.
[0m22:11:22.090580 [debug] [MainThread]: On model.estat_dbt.fact_expense: Close
[0m22:11:22.386681 [info ] [MainThread]: 
[0m22:11:22.387894 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m22:11:22.390236 [debug] [MainThread]: Command end result
[0m22:11:22.423722 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/manifest.json
[0m22:11:22.425994 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/semantic_manifest.json
[0m22:11:22.431977 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tthuha236/Documents/Learning_2025/sidepj/estat_dbt/target/run_results.json
[0m22:11:22.432334 [info ] [MainThread]: 
[0m22:11:22.432829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:22.433214 [info ] [MainThread]: 
[0m22:11:22.433663 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:11:22.435801 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1782722, "process_in_blocks": "0", "process_kernel_time": 0.707896, "process_mem_max_rss": "146640896", "process_out_blocks": "0", "process_user_time": 2.914734}
[0m22:11:22.436555 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:22.436419 after 6.18 seconds
[0m22:11:22.437079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db94b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094adcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934df90>]}
[0m22:11:22.437564 [debug] [MainThread]: Flushing usage events
[0m22:11:24.076070 [debug] [MainThread]: An error was encountered while trying to flush usage events
