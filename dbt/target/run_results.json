{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.0b2", "generated_at": "2025-10-05T02:02:34.594648Z", "invocation_id": "b43049cc-6e0c-4f90-a60e-04a869939aba", "invocation_started_at": "2025-10-05T02:02:24.300441Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.217156Z", "completed_at": "2025-10-05T02:02:34.220229Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.221779Z", "completed_at": "2025-10-05T02:02:34.221815Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03160810470581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.estat_dbt.dim_city_region_stg", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.192878Z", "completed_at": "2025-10-05T02:02:34.225446Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.227796Z", "completed_at": "2025-10-05T02:02:34.227854Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.039044857025146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.estat_dbt.dim_expense_category", "compiled": true, "compiled_code": "WITH stg_table AS (\n    SELECT * FROM estat_db.estat_stg.dim_expense_category_stg\n     WHERE loaded_time = (\n        SELECT max(loaded_time) from estat_db.estat_stg.dim_expense_category_stg \n    )\n) \nSELECT \n    CATEGORY_CD,\n    MAIN_CATEGORY_NAME,\n    SUB_CATEGORY_NAME,\n    DETAILED_CATEGORY_NAME,\n    DESCRIPTION\nFROM \n    stg_table", "relation_name": "estat_db.estat_transformed.dim_expense_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.206494Z", "completed_at": "2025-10-05T02:02:34.226461Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.229125Z", "completed_at": "2025-10-05T02:02:34.229144Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.039576053619384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.estat_dbt.fact_expense", "compiled": true, "compiled_code": "WITH stg_table AS (\n    SELECT * FROM estat_db.estat_stg.fact_expense_stg \n    \n    WHERE loaded_time = (\n        SELECT max(loaded_time) from estat_db.estat_stg.fact_expense_stg \n    )\n    \n)\nSELECT \n    s.category_cd,\n    s.amount, \n    s.area_cd, \n    s.year,\n    s.month,\n    COALESCE(t.created_at, CURRENT_TIMESTAMP()) as created_at,\n    CURRENT_TIMESTAMP() as updated_at,\n    COALESCE(t.created_by, CURRENT_USER()) as created_by,\n    CURRENT_USER() as updated_by\nFROM stg_table s", "relation_name": "estat_db.estat_transformed.fact_expense", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.230325Z", "completed_at": "2025-10-05T02:02:34.233560Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.236833Z", "completed_at": "2025-10-05T02:02:34.236853Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013255834579467773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.estat_dbt.dim_city_stg", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.242406Z", "completed_at": "2025-10-05T02:02:34.279097Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.280593Z", "completed_at": "2025-10-05T02:02:34.280627Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.042498111724853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.estat_dbt.not_null_dim_city_region_stg_ken_name.f8d5a315eb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ken_name\nfrom estat_db.estat_stg.dim_city_region_stg\nwhere ken_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.260910Z", "completed_at": "2025-10-05T02:02:34.279826Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.281891Z", "completed_at": "2025-10-05T02:02:34.281909Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04301905632019043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.estat_dbt.unique_dim_city_region_stg_ken_name.1859a6f8b7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ken_name as unique_field,\n    count(*) as n_records\n\nfrom estat_db.estat_stg.dim_city_region_stg\nwhere ken_name is not null\ngroup by ken_name\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.272746Z", "completed_at": "2025-10-05T02:02:34.283158Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.285729Z", "completed_at": "2025-10-05T02:02:34.285747Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04413294792175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.estat_dbt.dim_location", "compiled": true, "compiled_code": "WITH city AS (\n    SELECT * FROM estat_db.estat_stg.dim_city_stg \n),\nregion AS (\n    SELECT * FROM estat_db.estat_stg.dim_city_region_stg\n)\nSELECT \n    c.KEN_CODE,\n    c.SITYOUSON_CODE,\n    c.TIIKI_CODE,\n    c.KEN_NAME,\n    c.SITYOUSON_NAME1,\n    c.SITYOUSON_NAME2,\n    c.SITYOUSON_NAME3,\n    c.YOMIGANA,\n    r.CHIHOU,\n    CURRENT_TIMESTAMP() AS CREATED_TIME\nFROM city c\nJOIN region r\n  ON c.KEN_NAME = r.KEN_NAME", "relation_name": "estat_db.estat_transformed.dim_location", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.291039Z", "completed_at": "2025-10-05T02:02:34.316115Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.317639Z", "completed_at": "2025-10-05T02:02:34.317659Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03108501434326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.estat_dbt.not_null_dim_city_stg_tiiki_code.7e79b1abe4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tiiki_code\nfrom estat_db.estat_stg.dim_city_stg\nwhere tiiki_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.297571Z", "completed_at": "2025-10-05T02:02:34.316889Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.319829Z", "completed_at": "2025-10-05T02:02:34.319859Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.032633066177368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.estat_dbt.unique_dim_city_stg_tiiki_code.b6ad87d843", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    tiiki_code as unique_field,\n    count(*) as n_records\n\nfrom estat_db.estat_stg.dim_city_stg\nwhere tiiki_code is not null\ngroup by tiiki_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.307844Z", "completed_at": "2025-10-05T02:02:34.318966Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.322092Z", "completed_at": "2025-10-05T02:02:34.322108Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03219485282897949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.estat_dbt.agg_expense_by_main_category", "compiled": true, "compiled_code": "WITH agg_expense as (\n    SELECT\n        loc.ken_name,\n        loc.chihou,\n        f.year,\n        f.month,\n        c.main_category_name,\n        AVG(f.amount) AS amount,\n    FROM estat_db.estat_transformed.fact_expense AS f\n    JOIN estat_db.estat_transformed.dim_location AS loc\n        ON f.area_cd = loc.tiiki_code\n    JOIN estat_db.estat_transformed.dim_expense_category c\n        ON f.category_cd = c.category_cd AND c.sub_category_name is null AND c.detailed_category_name is null\n    \n        -- only get new or updated data\n        WHERE f.updated_at >= COALESCE((SELECT MAX(updated_at) from estat_db.estat_mart.agg_expense_by_main_category), '1900-01-01')\n    \n    GROUP BY 1,2,3,4,5\n)\nSELECT a.*,\n    COALESCE(t.created_at, CURRENT_TIMESTAMP()) AS created_at,\n    CURRENT_TIMESTAMP() as updated_at,\n    COALESCE(t.created_by, CURRENT_USER()) AS created_by,\n    CURRENT_USER() as updated_by\nFROM agg_expense a \nLEFT JOIN estat_db.estat_mart.agg_expense_by_main_category t \nON a.ken_name = t.ken_name\n AND a.year = t.year\n AND a.month = t.month\n AND a.main_category_name = t.main_category_name", "relation_name": "estat_db.estat_mart.agg_expense_by_main_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.326506Z", "completed_at": "2025-10-05T02:02:34.341116Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.342662Z", "completed_at": "2025-10-05T02:02:34.342682Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019320011138916016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.estat_dbt.agg_expense_by_sub_category", "compiled": true, "compiled_code": "WITH agg_expense as (\n    SELECT\n        loc.ken_name,\n        loc.chihou,\n        f.year,\n        f.month,\n        c.main_category_name,\n        c.sub_category_name,\n        AVG(f.amount) AS amount,\n    FROM estat_db.estat_transformed.fact_expense AS f\n    JOIN estat_db.estat_transformed.dim_location AS loc\n        ON f.area_cd = loc.tiiki_code\n    JOIN estat_db.estat_transformed.dim_expense_category c\n        ON f.category_cd = c.category_cd AND c.sub_category_name is not null AND c.detailed_category_name is null\n    \n        -- only get new or updated data\n        WHERE f.updated_at >= COALESCE((SELECT MAX(updated_at) from estat_db.estat_mart.agg_expense_by_sub_category), '1900-01-01')\n    \n    GROUP BY 1,2,3,4,5,6\n)\nSELECT a.*,\n    COALESCE(t.created_at, CURRENT_TIMESTAMP()) AS created_at,\n    CURRENT_TIMESTAMP() as updated_at,\n    COALESCE(t.created_by, CURRENT_USER()) AS created_by,\n    CURRENT_USER() as updated_by\nFROM agg_expense a \nLEFT JOIN estat_db.estat_mart.agg_expense_by_sub_category t \nON a.ken_name = t.ken_name\n AND a.year = t.year\n AND a.month = t.month\n AND a.sub_category_name = t.sub_category_name", "relation_name": "estat_db.estat_mart.agg_expense_by_sub_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-05T02:02:34.335841Z", "completed_at": "2025-10-05T02:02:34.344913Z"}, {"name": "execute", "started_at": "2025-10-05T02:02:34.345557Z", "completed_at": "2025-10-05T02:02:34.345572Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011526107788085938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.estat_dbt.agg_expense_monthly_total", "compiled": true, "compiled_code": "WITH src AS (\n  SELECT ken_name,\n        chihou,\n        year,\n        month,\n        SUM(src.amount) AS total_amount\n  FROM estat_db.estat_mart.agg_expense_by_main_category src\n    \n  GROUP BY 1,2,3,4\n)\nSELECT \n  src.*,\n  COALESCE(t.created_at, CURRENT_TIMESTAMP()) AS created_at,\n  CURRENT_TIMESTAMP() AS updated_at,\n  COALESCE(t.created_by, CURRENT_USER()) AS created_by,\n  CURRENT_USER() AS updated_by\nFROM src\nLEFT JOIN estat_db.estat_mart.agg_expense_monthly_total t\n ON src.ken_name = t.ken_name\n AND src.year = t.year\n AND src.month = t.month", "relation_name": "estat_db.estat_mart.agg_expense_monthly_total", "batch_results": null}], "elapsed_time": 3.753598928451538, "args": {"partial_parse_file_diff": true, "introspect": true, "profiles_dir": "/Users/tthuha236/.dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse": true, "state_modified_compare_more_unrendered_values": false, "version_check": true, "favor_state": false, "log_format_file": "debug", "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_vars": false, "require_batched_execution_for_custom_microbatch_strategy": false, "select": [], "macro_debugging": false, "log_path": "/Users/tthuha236/Documents/Learning_2025/sidepj/dbt/logs", "which": "generate", "write_json": true, "static": false, "printer_width": 80, "require_resource_names_without_spaces": true, "vars": {}, "show_all_deprecations": false, "require_nested_cumulative_type_params": false, "empty_catalog": false, "log_level_file": "debug", "quiet": false, "cache_selected_only": false, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "use_colors_file": true, "source_freshness_run_project_hooks": true, "show_resource_report": false, "validate_macro_args": false, "log_file_max_bytes": 10485760, "strict_mode": false, "upload_to_artifacts_ingest_api": false, "log_level": "info", "warn_error_options": {"error": [], "warn": [], "silence": []}, "defer": false, "use_fast_test_edges": false, "require_all_warnings_handled_by_warn_error": false, "compile": true, "exclude": [], "project_dir": "/Users/tthuha236/Documents/Learning_2025/sidepj/dbt", "log_format": "default", "populate_cache": true, "use_colors": true, "require_generic_test_arguments_property": true, "invocation_command": "dbt docs generate", "static_parser": true, "print": true, "require_yaml_configuration_for_mf_time_spines": false}}